# 1. 创建虚拟机，本质在做哪些事？

先给你一句**总纲**：

> **创建虚拟机 = 给一台“假电脑”分配硬件资源 + 接好网络 + 准备装系统**

这台“假电脑”会有：

|真实电脑|虚拟机|
|---|---|
|主板|虚拟主板|
|CPU|vCPU|
|内存|虚拟内存|
|硬盘|虚拟磁盘|
|网卡|虚拟网卡|
|U 盘 / 光驱|ISO|
# 2. PVE 中「创建虚拟机」完整流程
## 2.1  常规配置
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2013.39.50.png)
这里我们一般是配置这里的==**VM ID**==和==**名称**==
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2013.43.29.png)
## 2.2 OS（操作系统）
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2013.48.27.png)
 **核心问题：**

👉 **这台虚拟机是“怎么启动的”？**

### 2.2.1 常见选择

**✔ Use CD/DVD disc image file (iso)**

>- 用 ISO 装系统（Linux / Windows）

**✔ Do not use any media**

>- iStoreOS / OpenWRT 常用
>- 稍后手动导入磁盘

### 2.2.2 ISO 文件从哪来？

👉 **PVE 的存储库（local）里**
`Datacenter → Storage → local → ISO Images`
## 2.3 System（系统）
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2013.48.50.png)
这里是**很多人第一次会懵的地方**，但你现在能懂。
### 2.3.1 BIOS

|选项|建议|
|---|---|
|SeaBIOS|老系统 / 简单|
|OVMF (UEFI)|**现代系统推荐**|

👉 **Linux / Windows 10+ / iStoreOS → UEFI**
#### SeaBIOS 是什么？

**本质**

>- 传统 PC BIOS 的模拟实现
>- 诞生很早（DOS / Win7 以前时代）

**特点**

>- 只能从 **MBR 磁盘** 启动
>- 不需要额外启动盘
>- 启动流程简单

**🧠 类比**

老台式机：

>- 黑底白字
>- 按 `Del` 进 BIOS

#### UEFI（OVMF）是什么？

**本质**

>- 新一代固件标准
>- PVE 中叫 **OVMF**

**特点**

>- 使用 **GPT 分区**
>- 启动信息存放在 **EFI 分区**
>- 支持大硬盘、Secure Boot（可选）
>- 现代 Linux / Windows 默认

**🧠 类比**

新电脑：

>- 彩色界面
>- 支持鼠标
>- NVMe / 大硬盘

#### SeaBIOS vs UEFI 的关键区别（你要记住的）

|对比点|SeaBIOS|UEFI|
|---|---|---|
|启动时代|老|新|
|磁盘分区|MBR|GPT|
|EFI 分区|不需要|**必须**|
|大于 2TB|❌|✅|
|Secure Boot|❌|可选|
|现代系统|勉强|**原生**|
|PVE 推荐|❌|**✅**|
#### EFI Disk 是干嘛的？（重点！）

你这一步如果不理解，后面会踩坑。

**1️⃣ EFI Disk 的本质**

> **EFI Disk = UEFI 的“启动配置盘”**

它不是系统盘  
它不装你的 Linux  
它只存：

>- 启动项
>- NVRAM 变量
>- bootloader 路径


 **类比（非常重要）**

现实电脑：

- 主板里有一块 **NVRAM**
- 专门存：
    - 启动顺序
    - EFI 启动项

👇  
**虚拟机没有主板**  
👇  
PVE 就用 **EFI Disk 来模拟这块区域**

 **2️⃣ 如果没有 EFI Disk 会怎样？**

你之前见过这个报错 👇（对上了）

`WARN: no efidisk configured! Using temporary efivars disk.`

含义是：

> “你选了 UEFI，但没给我 EFI Disk  
> 我只能临时凑一个  
> 重启可能丢启动信息”

结果常见表现：

- 装完系统
- 重启进不去
- 找不到启动项

#### EFI Disk 怎么选？（实操）
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2014.07.11.png)
在 **System** 页面：

**必须勾选：**

- ✅ Add EFI Disk

 **参数建议：**

|项目|推荐|
|---|---|
|Storage|local-lvm|
|Format|raw|
|Size|默认（几 MB）|
|Secure Boot|❌ 关闭（除非你知道在干嘛）|


### 2.3.2 机型

>- `q35`（新）
>- `i440fx`（老）

👉 **选 择**
>- 这里的i440fx不支持最新的PCIe或一些NVME但是兼容性最好
>- q35是支持一些新的设备的。



### 2.3.3  SCSI Controller

👉 **VirtIO SCSI**

性能最好，CPU 占用低。
# 2.3 磁盘
这里看我们用的是iso的格式还是img的格式。iso和img的区别[4. 总结](../iso和img.md#4.%20总结)
### 2.3.1 iso的格式
就看![1.4PVE 里 ISO 的用法](../iso和img.md#1.4PVE%20里%20ISO%20的用法)
然后在硬盘这里选择大小
![2000](assets/如何创建PVE虚拟机/截屏2026-01-31%2014.35.33.png)
### 2.3.2 img格式
![2.4  PVE 里 IMG 的用法](../iso和img.md#2.4%20PVE%20里%20IMG%20的用法)
这里的我们的==操作系统==选==择不使用任何介质==，并且在磁盘这里我们也都删掉。因为后续我们会用命令把我们的img的文件导入磁盘。之后在==硬件==这里的==硬盘==就会出现我们的磁盘。
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2014.39.59.png)
## 2.4 cpu
![](assets/如何创建PVE虚拟机/截屏2026-01-31%2014.41.10.png)
这里的==插槽==指的是cpu的数量
这里的==**类别**==我们一般用==**host**==
