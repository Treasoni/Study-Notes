# 1.PVE 里其实有「两种存储库」

| 名字         | 中文常被叫 | 实际作用               |
| ---------- | ----- | ------------------ |
| Storage    | 存储库   | 放 VM 磁盘 / ISO / 备份 |
| Repository | 更新存储库 | 系统和组件的更新源          |

你现在问的是 **第二个** 
# 2. 更新存储库
##  2.1更新里的“存储库”到底是干嘛的？

 🧠 **人话解释**

> **PVE 去哪里下载系统更新、补丁、内核、Web 界面、QEMU、LXC 等软件**

本质就是 **APT 软件源**。


## 2.2 你在「更新 → 存储库」里看到的都是什么？

通常你会看到这些（举例）：

### 1️⃣ `pve-enterprise`

- 🔒 官方企业源
- ❌ **需要订阅**
- 没订阅就会报错 / 弹提示

📌 **个人 / 学习环境不该用**


### 2️⃣ `pve-no-subscription` ⭐⭐⭐

- ✅ 免费
- ✅ 官方提供
- ❗ 更新略微激进（但稳定）

📌 **个人玩家 / 家用 / 实验环境首选**


### 3️⃣ `ceph` 相关源（如果你没用 Ceph）

- ❌ 可以禁用
- 否则更新会报错


### 4️⃣ Debian 官方源

- `bookworm`
- `security`
- `updates`

👉 **PVE 本质是 Debian + PVE 组件**


## 2.3 这个“存储库”不对，会发生什么？

### ❌ 常见后果

- 更新失败
- `apt update` 报错
- Web UI 一直提示：
    `You do not have a valid subscription`

📌 **但不会影响虚拟机运行**  
📌 **只是你没法升级系统**
# 3. 存储库
==**一句话先给你结论**==

> **PVE 的“存储库（Storage）”= 用来放虚拟机和容器“所有东西的仓库”**

只要是 **虚拟机 / 容器 / ISO / 备份**，  
**99% 都是从存储库里来、放回存储库里去。**

## 3.1 PVE 里“存储库”到底放什么？

你可以把它理解成一个**带权限和用途标签的硬盘池**。

 **常见能放的东西有：**

|类型|说明|
|---|---|
|ISO 镜像|系统安装盘（iStoreOS、Ubuntu 等）|
|VM 磁盘|虚拟机真正的“硬盘”|
|CT 磁盘|LXC 容器的文件系统|
|备份|vzdump 生成的 `.zst`|
|Snippets|cloud-init / 脚本|
|模板|容器模板|


## 3.2 为什么 PVE 要搞“存储库”，不直接用磁盘？

因为 PVE 要解决 3 件事：

### ① 统一管理（这是核心）

不管你用的是：

>- 本地 SSD
>- 机械盘
>- NAS
>- iSCSI
>- NFS
>- ZFS

👉 **在 PVE 眼里，全都叫 Storage**
### ② 控制“能干嘛”（非常重要）

每个存储库都有 **内容类型限制**：

比如：

- `local`：
    - ✔ ISO
    - ✔ Backup
    - ✔ Snippets
- `local-lvm`：
    - ✔ VM Disk
    - ❌ ISO
    - ❌ Backup

👉 **不是所有盘都能放所有东西**
### ③ 为迁移 / 备份 / 高可用服务

- VM 迁移
- 在线备份
- 多节点集群

全都依赖 **存储库抽象**

# 4. 你现在 PVE 里最常见的两个存储库（一定有）

![3000](assets/PVE存储库/截屏2026-01-30%2022.49.20.png)
## 1️⃣ `local`

👉 本质：

>- `/var/lib/vz`
>- 普通目录

👉 常用来：

>- ISO
>- 备份
>- 模板

📌 **不适合放虚拟机磁盘（性能一般）**

## 2️⃣ `local-lvm`

👉 本质：

>- LVM Thin Pool
>- 块存储

👉 常用来：

>- VM 磁盘
>- 容器磁盘

📌 **不能存 ISO / 备份**

# 5. 结合你装 iStoreOS 的场景举例

你在创建 iStoreOS 虚拟机时：

**1️⃣ ISO 从哪里选？**

👉 **Storage: local**

**2️⃣ 硬盘放哪里？**

👉 **Storage: local-lvm**

这就是为什么你**创建 VM 时要选两次存储**。
# 6. 存储库 ≠ 一块硬盘（这是关键认知）

一个存储库可以是：

>- 一块硬盘的一部分
>- 一个目录
>- 一个网络挂载
>- 一个逻辑池

👉 **你是在“用存储”，不是“用盘”**


# 7.什么时候你需要“新建存储库”？

你会在这些情况用到：

>- 加了一块新盘
>- 挂了 NAS
>- 想把备份单独放
>- 想做快照 / ZFS
>- VM 太多想分流


# 8.一句话记忆法（很好记）

> **PVE = 计算 + 网络 + 存储**
> 
> 存储库 =  
> 👉 **虚拟机的“粮仓”**

