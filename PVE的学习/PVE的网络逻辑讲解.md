---
tags:
  - pve
---

# 1. 网桥（Bridge / vmbr）
```css
[ 物理网线 ]
     │
[ 物理网卡 eno1 ]
     │
┌───────────────┐
│   Linux Bridge│  ← vmbr0（虚拟交换机）
└───────────────┘
   │        │
[ vNIC ]  [ vNIC ]
  VM1       VM2
```
再加个“直通”的对照：

```css
[ 物理网卡 eno2 ] ─── 直通 ───> VM（独占）

```
## 1.1 它是什么？

**vmbr = Linux Bridge = 二层交换机**

👉 本质：

>- 不做 NAT
>- 不做路由
>- 只做 **MAC 转发**

 **🧠 类比现实**

想象你桌子上有一个：

> **5 口千兆交换机**

- 插了：
    
    - 一根网线（物理网卡）
    - 几台电脑（虚拟机）

这台交换机 = `vmbr0`

## 1.2 关键特性

>- 工作在 **OSI 第二层**
>- VM 看不到宿主机存在
>- 跟接在实体交换机上 **没有区别**

## 1.3  为什么 PVE 必须用网桥？

因为虚拟机需要：

>- 拿真实 IP（192.168.x.x）
>- 被路由器当成真实设备

# 2. 直通（PCI Passthrough / 网卡直通）

## 2.1 它是什么？

**把一张“真实物理网卡”完全交给某个 VM**

宿主机：  
❌ 不再拥有  
❌ 看不见  
❌ 不能用

虚拟机：  
✅ 当成“原生网卡”

 **🧠 类比现实**

你从主板上：

>- 拔下一张网卡
>- 插进另一台电脑

## 2.2 典型用途

>- 软路由（iStoreOS / OpenWRT）
>- 防火墙
>- 高性能网络
>- PPPoE 拨号

## 2.3 直通的代价

|优点|缺点|
|---|---|
|性能最好|宿主机失去该网卡|
|网络最干净|不灵活|
|不走 vmbr|不能和其他 VM 共|
# 3. 虚拟网卡（vNIC）
![](assets/PVE的网络逻辑讲解/截屏2026-01-31%2012.12.51.png)
一般在创建虚拟机中配置。

## 3.1  它是什么？

**给虚拟机用的“网卡”**

在 PVE 里你会看到：

>- VirtIO
>- Intel E1000
>- Realtek（不推荐）

 **🧠 类比现实**

你在电脑主板上插了一张：

> PCIe 网卡

只不过：

>- 这是 **虚拟的**
>- 插在 **vmbr 上**

## 3.2  特点

- 每个 VM 至少一张
- 有：
    - MAC 地址
    - IP（由 DHCP / 静态）
- 性能最高的是：**VirtIO**(半虚拟化)

## 3.3 正确认识网桥和虚拟网卡

> **网桥（vmbr）就是一台二层交换机**  
> **网卡（虚拟网卡 vNIC / 物理网卡）就是交换机上的端口**  
> **虚拟机通过虚拟网卡“插”在交换机端口上**

# 4. 内交换 / 外交换

这俩词非常形象，我用你现在的 PVE 场景讲。


## 4.1 内交换（Internal Switching）
![2000](assets/PVE的网络逻辑讲解/截屏2026-01-31%2012.22.09.png)
**流量不出宿主机**
像图中的Routeros主路由和飞牛等NAS就是内交换。

`VM1 ── vmbr ── VM2`

>- 不经过物理网卡
>- 不经过路由器
>- 延迟极低

🧠 类比：  
同一个交换机下，两台电脑互 ping


## 4.2  外交换（External Switching）

**流量走物理网络**

`VM ─ vmbr ─ eno1 ─ 路由器 ─ 互联网`

>- 出 PVE
>- 走交换机 / 路由器


## 4.3 什么时候是内交换？

>- 同一个 vmbr
>- 同一个宿主机
>- 不访问外部 IP



