---
tags:
  - ai
---
建议先阅读 [Skills 是什么](Skills%20是什么.md) 了解基本概念

# 如何编写 Skills（实战指南）

## 1. 写 Skills 前的准备

> 🎯 **开餐厅比喻**
>
> 在开店之前，你需要先想清楚：
> - 这家店卖什么菜？（功能定位）
> - 目标客群是谁？（使用场景）
> - 菜单怎么设计？（用户交互）
> - 厨师怎么做菜？（执行逻辑）

编写 Skills 也是同样的思路：

### 1.1 明确三个核心问题

| 问题 | 解释 | 例子 |
|------|------|------|
| **这个 Skill 做什么？** | 单一明确的功能 | "生成SQL查询" |
| **谁来用？什么时候用？** | 目标场景 | 用户问数据库相关问题时 |
| **输入什么？输出什么？** | 接口设计 | 输入：业务需求；输出：SQL语句 |

### 1.2 命名你的 Skill

> 🎯 **身份证比喻**
>
> 好的名字就像身份证，一看就知道是谁、做什么的。

**命名规则：**
- 使用小写字母和下划线
- 名字要能一眼看出功能
- 不要太长（建议 2-4 个单词）

| 好的命名 | 不好的命名 | 原因 |
|---------|-----------|------|
| `sql_generator` | `skill1` | 没有描述功能 |
| `code_reviewer` | `my_awesome_code_reviewer_v2` | 太长太复杂 |
| `markdown_helper` | `md-helper` | 避免非标准符号 |

---

## 2. 创建 Skill 文件夹结构

> 🎯 **建房子比喻**
>
> 每个房子都需要一个独立的门牌号（文件夹），
> 里面有房间说明（skill.md）和房屋简介（metadata.json）。

### 2.1 标准结构

```
.claude/
└── skills/
    └── sql_generator/              ← Skill 文件夹（与命名一致）
        ├── skill.md                ← 核心逻辑文件
        └── metadata.json           ← 能力描述文件
```

### 2.2 创建步骤

```bash
# 1. 在用户目录下创建 skills 文件夹（如果不存在）
mkdir -p ~/.claude/skills

# 2. 创建你的 skill 文件夹
mkdir -p ~/.claude/skills/sql_generator

# 3. 创建两个必需文件
touch ~/.claude/skills/sql_generator/skill.md
touch ~/.claude/skills/sql_generator/metadata.json
```

---

## 3. 编写 metadata.json

> 🎯 **招聘简历比喻**
>
> metadata 就像一份简历：
> - 一眼看到核心能力（不读所有细节）
> - HR 用它快速筛选候选人
> - 节省双方时间

### 3.1 为什么需要 metadata？

**场景：** 你有 100 个 Skills

- ❌ 没有 metadata：AI 必须读取 100 个 `skill.md` 才知道每个做什么
- ✅ 有 metadata：AI 只读取 100 个简短的 JSON，按需加载详细内容

**效果：** Token 消耗减少 90% 以上！

### 3.2 metadata.json 完整示例

```json
{
  "name": "sql_generator",
  "description": "根据自然语言描述生成 SQL 查询语句",
  "use_cases": [
    "用户需要查询数据库时",
    "用户需要编写复杂 SQL 时",
    "用户需要优化 SQL 查询时"
  ],
  "keywords": ["SQL", "数据库", "查询", "SELECT", "表"],
  "when_to_use": "当用户的问题涉及数据库查询、数据检索或 SQL 语句编写时",
  "category": "code_generation"
}
```

### 3.3 字段详解

| 字段 | 说明 | 示例 | 必填 |
|------|------|------|------|
| `name` | Skill 唯一标识符 | `"sql_generator"` | ✅ |
| `description` | 一句话描述功能 | `"生成 SQL 查询"` | ✅ |
| `use_cases` | 使用场景列表 | `["查询数据", "优化SQL"]` | ✅ |
| `keywords` | 关键词用于匹配 | `["SQL", "数据库"]` | ✅ |
| `when_to_use` | 触发条件描述 | `"涉及数据库问题时"` | ✅ |
| `category` | 分类标签 | `"code_generation"` | ❌ |

### 3.4 编写技巧

> 🎯 **SEO 优化比喻**
>
> 写 metadata 就像给网站做 SEO 优化，关键词要精准。

1. **关键词选择：**
   - 包含专业术语：`["SQL", "PostgreSQL", "MySQL"]`
   - 包含常见动词：`["查询", "检索", "写入"]`
   - 避免太泛的词：不要用 `["帮助", "工具"]`

2. **when_to_use 要具体：**
   - ❌ 模糊：`"用户需要帮助时"`
   - ✅ 具体：`"当用户问题包含'表'、'查询'、'SQL'等关键词时"`

---

## 4. 编写 skill.md

> 🎯 **菜谱比喻**
>
> skill.md 就像一份详细菜谱：
> - 食材准备（输入要求）
> - 烹饪步骤（执行流程）
> - 成品标准（输出规范）
> - 注意事项（禁忌/提示）

### 4.1 skill.md 的核心结构

```
┌─────────────────────────────────────────────────┐
│  1. 角色设定（Role）                             │
│     "你是一个什么身份..."                         │
├─────────────────────────────────────────────────┤
│  2. 能力描述（Capabilities）                     │
│     "你能够..."                                  │
├─────────────────────────────────────────────────┤
│  3. 工作流程（Workflow）                         │
│     "按以下步骤执行..."                          │
├─────────────────────────────────────────────────┤
│  4. 输出规范（Output Format）                    │
│     "输出格式必须..."                            │
├─────────────────────────────────────────────────┤
│  5. 约束条件（Constraints）                      │
│     "注意..." / "不要..."                        │
└─────────────────────────────────────────────────┘
```

### 4.2 完整示例：SQL 生成器

```markdown
# SQL 查询生成器

## 角色
你是一个专业的 SQL 数据库查询编写专家，精通 MySQL、PostgreSQL、SQLite 等主流数据库的语法特性。

## 能力
你能够根据用户的自然语言描述，生成准确、高效、安全的 SQL 查询语句。

## 工作流程

### 步骤 1：分析需求
- 仔细阅读用户的查询需求
- 识别涉及的表名、字段名
- 确定查询类型（SELECT/INSERT/UPDATE/DELETE）
- 理解筛选条件和排序要求

### 步骤 2：构建查询
- 根据分析结果构建 SQL 语句
- 使用适当的 JOIN 处理关联表
- 添加必要的 WHERE 条件
- 按要求添加 ORDER BY 或 LIMIT

### 步骤 3：优化查询
- 检查是否可以优化性能
- 避免不必要的列查询
- 使用索引友好的条件

### 步骤 4：生成输出
- 输出格式化的 SQL 语句
- 添加简洁的注释说明

## 输出规范

```sql
-- 查询说明
SELECT id, name, email
FROM users
WHERE status = 'active'
  AND created_at >= '2024-01-01'
ORDER BY created_at DESC
LIMIT 100;
```

## 约束条件
- 必须使用参数化查询（用 $1, $2 占位符，不要直接拼接字符串）
- 永远不要生成没有 WHERE 条件的 UPDATE/DELETE 语句
- 添加适当的注释说明查询目的
- SQL 语句格式化，便于阅读
- 对于复杂查询，提供简要解释

## 示例

用户输入：
"查询所有活跃用户，按注册时间倒序排列，只返回前100条"

你的输出：
```sql
-- 查询活跃用户，按注册时间倒序
SELECT id, username, email, created_at
FROM users
WHERE status = 'active'
ORDER BY created_at DESC
LIMIT 100;
```
```

### 4.3 各部分编写技巧

#### 📌 角色设定（Role）

> 🎯 **演员角色比喻**
>
> 就像演员要进入角色一样，AI 需要明确"我是谁"。

| 技巧 | 说明 |
|------|------|
| 使用专业头衔 | "专家"、"工程师"、"顾问" |
| 明确专业领域 | "精通 Python"、"擅长数据库设计" |
| 赋予人格特质 | "严谨"、"注重细节"、"简洁明了" |

**示例：**
```
你是资深的 Python 代码审查专家，具有 10 年以上编程经验。
你善于发现代码中的潜在问题和性能瓶颈。
```

#### 📌 能力描述（Capabilities）

> 🎯 **求职简历技能栏比喻**
>
> 清晰列出你能做什么，让用户有明确预期。

**写作要点：**
- 用动词开头：能够、可以、擅长
- 列举具体能力
- 适度自信，不要过度承诺

**示例：**
```
你能够：
- 审查 Python 代码的语法错误
- 识别潜在的性能问题
- 提供优化建议
- 生成符合 PEP 8 规范的代码
```

#### 📌 工作流程（Workflow）

> 🎯 **导航地图比喻**
>
> 就像 GPS 导航一样，每一步都清晰指引方向。

**推荐结构：**
```
###工作流程
1. 分析输入
2. 处理数据
3. 生成结果
4. 验证输出
```

**编写技巧：**
- 每个步骤用编号标注
- 步骤之间有清晰的先后关系
- 每步只做一件事

#### 📌 输出规范（Output Format）

> 🎯 **建筑蓝图比喻**
>
> 精确规定成品的尺寸、样式、标准。

**内容要点：**
- 使用代码块展示格式
- 明确必需字段
- 说明可选字段
- 指定数据格式（JSON、Markdown、纯文本等）

**示例：**
```markdown
输出格式必须是 JSON：

```json
{
  "summary": "简要摘要",
  "details": ["详细条目1", "详细条目2"],
  "recommendation": "建议内容"
}
```
```

#### 📌 约束条件（Constraints）

> 🎯 **交通规则比喻**
>
> 告诉 AI 哪些可以做，哪些绝对禁止。

**常见约束类型：**

| 类型 | 例子 | 作用 |
|------|------|------|
| **安全性** | "不要执行系统命令" | 防止危险操作 |
| **格式** | "输出必须是 Markdown" | 保证格式一致 |
| **范围** | "只修改指定文件" | 限制作用范围 |
| **风格** | "使用简洁语言" | 控制输出风格 |

**写作技巧：**
- 用 "必须" 表示强约束
- 用 "不要" 表示禁止事项
- 用 "建议" 表示软性要求
- 提供正面和反面示例

---

## 5. 高级技巧

### 5.1 多文件组织

> 🎯 **模块化编程比喻**
>
> 当 skill.md 变得太长时，可以拆分成多个文件。

**结构：**
```
sql_generator/
├── skill.md          # 主入口文件
├── metadata.json
├── examples.md       # 示例集合
└── best_practices.md # 最佳实践
```

**skill.md 中引用其他文件：**
```markdown
## 参考示例
请参考 <<file:examples.md>> 中的示例来完成你的任务。

## 最佳实践
遵循 <<file:best_practices.md>> 中的指导原则。
```

### 5.2 添加测试用例

在 skill.md 中添加测试示例，帮助 AI 理解预期行为：

```markdown
## 测试用例

### 测试 1：简单查询
输入：查询所有用户
输出：SELECT * FROM users;

### 测试 2：带条件的查询
输入：查询状态为 active 的用户
输出：SELECT * FROM users WHERE status = 'active';
```

### 5.3 支持参数

如果你的 skill 需要接受参数，在文档中说明：

```markdown
## 参数说明

该 skill 支持以下参数：

| 参数 | 说明 | 默认值 |
|------|------|--------|
| --database | 数据库类型 | PostgreSQL |
| --format | 输出格式 | SQL |

使用示例：
- 基础用法：生成查询语句
- 指定数据库：生成 MySQL 语法查询
- 指定格式：生成带注释的 SQL
```

---

## 6. 调试你的 Skill

> 🎯 **试菜比喻**
>
> 菜谱写好后，要做一次试试味道是否合适。

### 6.1 调试清单

| 检查项 | 说明 |
|--------|------|
| ✅ metadata 格式正确 | JSON 语法无误 |
| ✅ 文件结构完整 | skill.md 和 metadata.json 都存在 |
| ✅ 名称一致 | 文件夹名与 metadata.name 匹配 |
| ✅ 测试触发 | 在 Claude Code 中测试能否识别 |
| ✅ 验证输出 | 实际运行检查输出质量 |

### 6.2 常见问题排查

| 问题 | 可能原因 | 解决方案 |
|------|----------|----------|
| Skill 不被识别 | metadata 格式错误 | 检查 JSON 语法 |
| 输出不符合预期 | skill.md 描述不清 | 加强约束条件 |
| AI 不调用此 Skill | when_to_use 不明确 | 优化关键词描述 |
| 输出太啰嗦 | 没有风格约束 | 添加简洁性约束 |

### 6.3 验证命令

```bash
# 检查文件结构
ls -la ~/.claude/skills/your_skill_name/

# 验证 JSON 格式
cat ~/.claude/skills/your_skill_name/metadata.json | jq .
```

---

## 7. 完整实战示例

让我们从头创建一个实用的 skill：**代码注释生成器**

### 7.1 创建文件

```bash
mkdir -p ~/.claude/skills/code_commenter
cd ~/.claude/skills/code_commenter
```

### 7.2 metadata.json

```json
{
  "name": "code_commenter",
  "description": "为代码添加清晰的注释和文档说明",
  "use_cases": [
    "为函数添加注释",
    "解释代码逻辑",
    "生成文档字符串"
  ],
  "keywords": ["注释", "文档", "docstring", "explain", "comment"],
  "when_to_use": "当用户要求为代码添加注释、解释代码或生成文档时",
  "category": "documentation"
}
```

### 7.3 skill.md

```markdown
# 代码注释生成器

## 角色
你是一个技术文档专家，擅长为代码添加清晰、规范的注释和文档说明。

## 能力
你能够：
- 为函数和方法添加清晰的注释
- 解释复杂的代码逻辑
- 生成符合语言规范的文档字符串（如 Python 的 docstring）
- 添加行内注释说明关键步骤

## 工作流程

1. **分析代码结构**
   - 识别函数、类、方法的边界
   - 理解代码的主要逻辑
   - 找出需要注释的关键部分

2. **生成文档注释**
   - 为函数添加文档字符串
   - 说明参数和返回值
   - 添加使用示例（如果适用）

3. **添加行内注释**
   - 为复杂逻辑添加说明
   - 解释关键算法
   - 标注重要的业务规则

4. **格式化输出**
   - 保持代码原有缩进
   - 使用标准注释风格
   - 确保注释简洁有效

## 输出规范

### Python 示例

```python
def calculate_discount(price, customer_level):
    """
    根据客户等级计算折扣价格

    Args:
        price: 商品原价
        customer_level: 客户等级（1-5，等级越高折扣越大）

    Returns:
        折扣后的价格
    """
    # 折扣率根据客户等级确定：等级1为无折扣，等级5为20%折扣
    discount_rate = (customer_level - 1) * 0.05

    # 计算折扣后的价格，保留两位小数
    discounted_price = round(price * (1 - discount_rate), 2)

    return discounted_price
```

### JavaScript 示例

```javascript
/**
 * 计算数组平均值
 * @param {number[]} numbers - 数字数组
 * @returns {number} 平均值
 */
function calculateAverage(numbers) {
    if (numbers.length === 0) {
        return 0;
    }

    // 使用 reduce 计算总和
    const sum = numbers.reduce((acc, num) => acc + num, 0);

    return sum / numbers.length;
}
```

## 约束条件

- 必须保持代码原有逻辑不变
- 只添加注释，不修改代码结构
- 使用目标语言的标准注释风格
- 注释要简洁，说明"为什么"而非"是什么"
- 对于显而易见的代码，不要添加冗余注释

## 语言注释风格

| 语言 | 函数注释 | 行内注释 | 文档格式 |
|------|----------|----------|----------|
| Python | `"""docstring"""` | `# 注释` | docstring |
| JavaScript | `/** JSDoc */` | `// 注释` | JSDoc |
| Java | `/** Javadoc */` | `// 注释` | Javadoc |
| Go | `// 函数注释` | `// 注释` | godoc |
```

### 7.4 测试验证

在 Claude Code 中测试：
```
给我这个函数添加注释：

function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}
```

预期 AI 会调用 `code_commenter` skill 并生成带注释的代码。

---

## 8. 最佳实践总结

> 🎯 **武功秘籍比喻**
>
> 像练武一样，掌握这些心法就能写出好 skill。

### ✅ DO（应该做的）

| 实践 | 说明 |
|------|------|
| **单一职责** | 每个 skill 只做一件事，做好一件事 |
| **明确命名** | 名字要一看就知道功能 |
| **完整文档** | metadata 和 skill.md 都要写好 |
| **提供示例** | 让 AI 通过例子学习 |
| **持续优化** | 根据使用反馈不断改进 |

### ❌ DON'T（不应该做的）

| 实践 | 说明 |
|------|------|
| **过于复杂** | 不要试图做一个全能 skill |
| **模糊描述** | metadata 的 when_to_use 要精确 |
| **冗余约束** | 只写必要的约束条件 |
| **忽略反馈** | AI 的错误输出提示你需要改进 |
| **硬编码** | 尽量让 AI 根据上下文推理 |

### 📋 开发检查清单

在发布 skill 之前，检查以下项目：

- [ ] 文件结构正确（文件夹、skill.md、metadata.json）
- [ ] metadata.json 格式正确，字段完整
- [ ] metadata.name 与文件夹名一致
- [ ] skill.md 包含角色、能力、流程、输出、约束
- [ ] 提供了清晰的示例
- [ ] 约束条件明确且合理
- [ ] 实际测试验证通过
- [ ] 关键词准确，能被正确识别

---

## 9. 下一步

现在你已经掌握了编写 Skills 的完整流程！

**推荐练习：**

1. 创建一个简单的 skill（如：格式化 JSON）
2. 创建一个中等复杂度的 skill（如：生成单元测试）
3. 尝试创建领域相关的 skill（如：Docker 配置生成器）

**进阶学习：**

- 研究 Claude Code 内置的 skills 源码
- 学习 Prompt Engineering 最佳实践
- 了解如何与 MCP 工具集成

---

> 💡 **一句话总结：编写 Skills = 写好 Prompt + 规范文档 + 持续迭代**
>
> 就像写作文一样，需要：
> - 明确主题（角色和功能）
> - 结构清晰（工作流程）
> - 规范格式（输出约束）
> - 反复修改（测试优化）
