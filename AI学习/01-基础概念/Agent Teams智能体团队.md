---
tags: [ai, 基础概念, agent-teams]
---

# Agent Teams 智能体团队

> [!info] 概述
> **Agent Teams 是"真正的团队"** - 产品经理、架构师、工程师、测试各司其职，可以互相讨论、协作、投票决策。适合需要多角色协作的复杂任务。

## 核心概念

### 什么是 Agent Teams

**定义**：多个独立 Agent 组成的协作网络，支持 Agent 之间直接通信、共享任务列表、自组织工作流

**核心特征**：
- 🤝 **直接通信**：Agent 之间可以直接对话，不需要通过中心协调
- 📋 **共享任务**：团队成员可以访问共享的任务列表
- 🎭 **角色分工**：每个 Agent 扮演特定角色（PM、架构师、工程师等）
- 🔄 **自组织**：团队可以自主决定工作流程

**比喻理解**：
```
Agent Teams = 真正的开发团队

产品经理 Agent ←→ 架构师 Agent ←→ 工程师 Agent
      ↑                ↑                ↑
      └────────────────┴────────────────┘
                  可以直接讨论协作

vs SubAgent = 老板 + 员工
老板派活 → 员工干活 → 汇报结果（只能跟老板说话）
```

### Agent Teams vs SubAgents 核心区别

| 维度 | SubAgents | Agent Teams |
|------|-----------|-------------|
| **会话模式** | 单会话内委派 | **跨多个独立会话**协作 |
| **通信拓扑** | 星型汇报（只向主Agent汇报） | **队员可直接互聊** |
| **协调机制** | 主Agent统一调度 | **共享任务列表，自协作** |
| **并行能力** | 顺序派发 | **真正并行执行** |
| **上下文** | 各自独立，不共享 | 可选择性共享信息 |
| **Token 成本** | 较高 | **最高**（可能是单Agent的10倍+） |
| **适用场景** | 单一复杂任务 | 多角色协作的复杂项目 |

### 核心特点

| 特点 | 说明 |
|------|------|
| **去中心化** | Agent 之间可以直接通信 |
| **角色专业化** | 每个 Agent 专注特定领域 |
| **协作模式多样** | 支持群聊、投票、流程流等 |
| **可扩展性** | 可以动态添加/移除 Agent |

---

## 技术细节

### 协作模式

Agent Teams 支持多种协作模式：

#### 1. 群聊模式（Group Chat）
```
┌─────────────────────────────────────────────────────────────┐
│                      群聊模式                                │
│                                                              │
│   ┌─────────┐                                               │
│   │   PM    │ ─────────────────────────────┐               │
│   └────┬────┘                              │               │
│        │                                   ↓               │
│        ↓         ┌─────────┐         ┌─────────┐          │
│   ┌─────────┐ ←─ │  架构师  │ ──────→ │  工程师  │          │
│   │  测试   │     └─────────┘         └─────────┘          │
│   └─────────┘          ↑                   │               │
│        │               └───────────────────┘               │
│        └─────────────────────────────────────┘             │
│                                                              │
│   所有 Agent 在同一个"群聊"中，可以自由发言、讨论            │
└─────────────────────────────────────────────────────────────┘
```

#### 2. 角色扮演模式（Role-Playing）
每个 Agent 扮演特定角色，按角色职责行动：
- PM Agent：定义需求、验收标准
- 架构师 Agent：设计系统结构
- 工程师 Agent：实现代码
- 测试 Agent：验证功能

#### 3. 流程流模式（Workflow）
```
需求分析 → 架构设计 → 代码实现 → 测试验证 → 部署发布
    ↑                                          │
    └────────────────── 反馈迭代 ←─────────────┘
```

### 主流框架对比

| 框架 | 语言 | 特点 | 适用场景 |
|------|------|------|----------|
| **CrewAI** | Python | 简单易用，角色定义清晰 | 快速搭建团队 |
| **LangGraph** | Python | 灵活的图结构，状态管理 | 复杂工作流 |
| **AutoGen** | Python | 微软出品，群聊模式强 | 多 Agent 对话 |
| **MetaGPT** | Python | 软件公司模拟，专业分工 | 软件开发 |
| **Swarm** | Python | OpenAI 出品，轻量级 | 简单协作 |

#### CrewAI 示例
```python
from crewai import Agent, Task, Crew

# 定义角色
pm = Agent(
    role="产品经理",
    goal="定义产品需求",
    backstory="经验丰富的产品专家"
)

engineer = Agent(
    role="工程师",
    goal="实现产品功能",
    backstory="全栈开发专家"
)

# 定义任务
task = Task(
    description="开发用户登录功能",
    agent=pm  # 先由 PM 分析需求
)

# 组建团队
crew = Crew(
    agents=[pm, engineer],
    tasks=[task]
)

# 执行
crew.kickoff()
```

### 工作原理图

```
┌─────────────────────────────────────────────────────────────────┐
│                     Agent Teams 架构                             │
│                                                                  │
│   用户需求："开发一个用户管理系统"                                │
│                                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                    共享任务列表                          │   │
│   │   [ ] 需求分析    [ ] 架构设计    [ ] 代码实现           │   │
│   │   [ ] 测试验证    [ ] 文档编写                           │   │
│   └─────────────────────────────────────────────────────────┘   │
│                            ↑                                     │
│            ┌───────────────┼───────────────┐                    │
│            │               │               │                    │
│   ┌────────┴────┐   ┌──────┴──────┐   ┌────┴────────┐          │
│   │  PM Agent   │   │ 架构师 Agent │   │ 工程师 Agent │          │
│   │             │   │             │   │             │          │
│   │ - 分析需求  │   │ - 设计架构  │   │ - 编写代码  │          │
│   │ - 验收标准  │   │ - 技术选型  │   │ - 实现功能  │          │
│   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘          │
│          │                 │                 │                  │
│          │    ┌────────────┴────────────┐    │                  │
│          └───▶│     Agent 通信通道       │◀───┘                  │
│               │  (可以直接互相发送消息)   │                      │
│               └─────────────────────────┘                       │
│                                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                      协作结果                            │   │
│   │   - 完整的需求文档                                       │   │
│   │   - 系统架构图                                           │   │
│   │   - 可运行的代码                                         │   │
│   │   - 测试报告                                             │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 成本考量

Agent Teams 是成本最高的方案：

| 成本因素 | 说明 |
|----------|------|
| **Agent 数量** | 每个 Agent 都需要独立的推理 |
| **通信开销** | Agent 之间的消息传递 |
| **并行执行** | 多个 Agent 同时工作 |
| **协调成本** | 需要额外的协调机制 |

**成本估算**：
```
单 Agent 成本 = 1x
SubAgent 成本 = 2-5x
Agent Teams 成本 = 5-20x（取决于团队规模）
```

---

## 与其他概念的关系

```
复杂度 / 成本
     ↑
     │                           ┌─────────────────┐
     │                           │  Agent Teams    │ ← 多Agent协作
     │                           │  (最高成本)      │
     │                    ┌──────┴─────────────────┘
     │                    │
     │             ┌──────┴──────┐
     │             │  SubAgent   │ ← 独立上下文
     │             │  (较高成本)  │
     │      ┌──────┴─────────────┘
     │      │
     │  ┌───┴────┐
     │  │ Agent  │ ← 工具调用
     │  │(中等成本)│
     │  └───┬────┘
     │      │
     │  ┌───┴────┐
     │  │ Prompt │ ← 基础对话
     │  │(最低成本)│
     │  └────────┘
     └─────────────────────────────────────→ 能力
```

| 概念 | 与 Agent Teams 的关系 |
|------|----------------------|
| [[Agent智能体]] | Agent Teams 由多个 Agent 组成 |
| [[SubAgent子代理]] | SubAgent 是单 Agent 内的扩展，Agent Teams 是多 Agent 协作 |
| [[Skills是什么]] | Skills 可以给团队成员使用 |
| [[MCP协议]] | Agent Teams 中的 Agent 通过 MCP 访问工具 |

---

## 最佳实践

### 何时使用 Agent Teams

**✅ 适合使用 Agent Teams 的场景**：
- 需要多个专业角色协作
- 任务可以并行分解
- Agent 之间需要讨论决策
- 项目价值足够高，值得高成本

**❌ 不适合使用 Agent Teams 的场景**：
- 单一简单任务
- 不需要多角色协作
- 成本敏感
- 任务可以线性完成

### 使用场景对比

| 场景 | 推荐方案 | 原因 |
|------|----------|------|
| 调试5个独立bug | Agent Teams | 真正并行，效率高 |
| 重构模块并写测试 | SubAgent | 需要独立上下文隔离 |
| 代码审查 | Agent | 线性任务，不需要隔离 |
| 复杂系统设计 | Agent Teams | 需要多角色讨论协作 |
| 简单功能开发 | Agent | 成本低，够用 |
| 大型项目开发 | Agent Teams | 需要专业分工协作 |

### 团队设计原则

1. **角色清晰**：每个 Agent 有明确的职责边界
2. **最小团队**：只包含必要的角色
3. **通信效率**：减少不必要的消息传递
4. **成本控制**：为简单角色使用便宜模型

### 常见陷阱

| 陷阱 | 问题 | 解决方案 |
|------|------|----------|
| **团队过大** | 成本过高，协调困难 | 只保留必要角色 |
| **角色重叠** | 职责不清，重复工作 | 明确职责边界 |
| **过度协作** | 简单任务复杂化 | 评估是否真的需要团队 |
| **忽略成本** | Token 消耗惊人 | 设置成本上限 |

---

## 常见问题

### Q1: Agent Teams 和 SubAgent 有什么本质区别？

**核心区别是通信拓扑**：
- **SubAgent**：星型拓扑，所有通信通过主 Agent
- **Agent Teams**：网状拓扑，Agent 之间可以直接通信

### Q2: 什么时候该用 Agent Teams？

**判断标准**：
1. 任务是否需要**多个专业角色**协作？
2. Agent 之间是否需要**直接对话讨论**？
3. 任务价值是否足够高，值得 10 倍 Token 成本？

如果三个问题都是 YES，才考虑 Agent Teams。

### Q3: Agent Teams 的成本有多高？

**估算**：
- 单 Agent：1x
- SubAgent：2-5x
- Agent Teams：5-20x

**建议**：仅用于高价值复杂任务。

### Q4: 如何选择框架？

| 需求 | 推荐框架 |
|------|----------|
| 快速上手 | CrewAI |
| 复杂工作流 | LangGraph |
| 群聊协作 | AutoGen |
| 软件开发 | MetaGPT |
| 轻量级需求 | Swarm |

---

## 相关文档

### 核心概念
- [[01-基础概念/人工智能重要的六大概念体系]] - 六大概念总览
- [[01-基础概念/Prompt提示词]] - Prompt 定义 Agent Teams 的任务目标
- [[01-基础概念/Agent智能体]] - Agent Teams 由多个 Agent 组成
- [[01-基础概念/MCP协议]] - Agent Teams 中的 Agent 通过 MCP 访问工具
- [[01-基础概念/Skills 是什么]] - Skills 可以给 Agent Teams 成员使用
- [[01-基础概念/SubAgent子代理]] - SubAgent 是单 Agent 内的扩展，Agent Teams 是多 Agent 协作

---

## 参考资料

- [CrewAI 官方文档](https://docs.crewai.com/)
- [LangGraph 文档](https://langchain-ai.github.io/langgraph/)
- [AutoGen GitHub](https://github.com/microsoft/autogen)
- [MetaGPT GitHub](https://github.com/geekan/MetaGPT)
- [OpenAI Swarm](https://github.com/openai/swarm)
- [Multi-Agent Systems Survey](https://arxiv.org/abs/2402.01680)
