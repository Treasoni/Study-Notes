---
tags: [claude, ai, 工具使用]
---

# Claude Code 常用功能

> [!info] 文档定位
> **本文档是功能速查手册** - 快速查找常用命令和操作。完整安装配置指南请参阅 [[如何使用Claude code]]

> [!info] 概述
> **Claude Code 是开发者的智能助手 CLI** - 集成了文件操作、代码编辑、Git 管理、任务追踪等功能，让你在终端中直接使用 Claude 进行软件工程任务。

## CLI 启动模式 🚀

Claude Code 有三种使用模式，适用不同场景：

| 模式 | 命令 | 特点 | 适用场景 |
|------|------|------|----------|
| **交互模式** | `claude` | 保持对话，有上下文 | 日常开发、多轮对话 |
| **单次执行** | `claude "query"` | 执行完自动退出 | 快速查询、脚本调用 |
| **打印模式** | `claude -p "query"` | 输出纯文本，可管道 | CI/CD、数据处理 |

```bash
# 交互模式 - 最常用
claude
claude "解释这个项目"          # 带初始提示启动

# 单次执行 - 执行完退出
claude "分析 auth.js 的安全问题" > review.txt

# 打印模式 - 适合管道处理
claude -p "生成10条测试数据" | jq '.users'
cat logs.txt | claude -p "分析错误原因"

# 常用启动参数
claude -c                      # 继续上次对话
claude -r "session-id"         # 恢复指定会话
claude --model opus            # 指定模型
claude --add-dir ../lib        # 添加额外目录
```

## 快捷键速查 ⌨️

| 快捷键 | 功能 |
|--------|------|
| `Tab` | 切换扩展思考模式 |
| `Shift + Tab` | 切换权限模式 |
| `Esc + Esc` | 打开 Rewind 回滚菜单 |
| `Ctrl + C` | 中断当前操作 |
| `Ctrl + D` | 退出会话 |
| `Ctrl + L` | 清屏（不清除对话） |
| `Ctrl + R` | 搜索历史输入 |
| `Ctrl + V` | 粘贴图片给 AI 分析 |
| `Ctrl + B` | 将任务移到后台 |
| `↑ / ↓` | 浏览历史命令 |

## 核心功能 💡

### 文件操作

**是什么**：直接读取、编辑、写入代码文件

**为什么需要**：
- 无需手动编辑文件
- 精确修改代码片段
- 批量处理多个文件

**常用工具**：
| 工具 | 功能 | 示例 |
|------|------|------|
| Read | 读取文件 | `读取 src/app.js` |
| Edit | 精确替换文本 | `将 console.log 替换为 logger.info` |
| Write | 创建/覆写文件 | `创建 config.yaml` |

### 代码搜索

**是什么**：快速定位代码和文件

**为什么需要**：
- 高效查找相关代码
- 理解项目结构
- 定位问题所在

**搜索方式**：
- **Glob** - 按模式匹配文件：`**/*.js`
- **Grep** - 搜索文件内容：`grep "TODO"`

### Git 集成

**是什么**：自动化代码提交流程

**为什么需要**：
- 自动生成 commit 消息
- 智能添加相关文件
- 遵循仓库提交风格

**常用操作**：
```bash
/commit                    # 创建提交
/commit -m "修复bug"       # 指定消息
```

### Checkpoint/Rewind 回滚机制 ⭐

**是什么**：Claude Code 的"时光机"功能，可以回退到之前的代码和对话状态

**为什么需要**：
- AI 改坏了代码，想撤回
- 尝试不同方案，不满意就重来
- 对话跑偏了，想重置 AI 记忆

**核心概念**：
> Checkpoint 就像游戏的"自动存档点" —— 每次你发送提示后，Claude 会自动创建一个快照，保存当前代码状态和对话记忆。

#### 如何触发回滚

```bash
# 方式一：命令
/rewind

# 方式二：快捷键（推荐，更快）
Esc + Esc（连按两下 Esc）
```

#### 三种回滚模式

| 模式 | 效果 | 适用场景 |
|------|------|----------|
| **仅代码** | 代码回滚，AI 记忆保留 | 代码改坏了，但 AI 理解你的意图 |
| **仅对话** | 代码保留，AI 记忆重置 | 对话跑偏了，代码没问题 |
| **代码和对话** | 完全回到过去 | 彻底推倒重来 |

#### 实战演示

**场景一：代码改坏了，保留理解**
```bash
你: "把 AuthService 重构成依赖注入模式"
Claude: [修改了 4 个文件，报错了]

# 回滚代码，保留对话
/rewind → 选择重构前 → 选择 "仅代码"

# AI 还知道你想做依赖注入，换个方式实现
你: "这次一步一步来，先只改 AuthService.java"
```

**场景二：对话跑偏，重置记忆**
```bash
# Claude 一直在提你拒绝的方案（比如 Redis）
你: "不用 Redis，就用 MySQL"
Claude: "好的，那我们加个 Redis 备用..."

# 回滚对话，保留代码
/rewind → 选择跑偏前 → 选择 "仅对话"

# AI "忘记" 之前的对话，不会再提 Redis
你: "继续优化，只用 MySQL"
```

**场景三：探索式重构，无畏试错**
```bash
你: "把所有 Controller 改成 WebFlux 响应式"
Claude: [15分钟改完 8 个文件]
你: "太复杂了，不要这个方案"

# 完全回滚
/rewind → 选择开始前 → 选择 "代码和对话"

# 瞬间回到原点，换方案
你: "这次用装饰器模式实现..."
```

#### 重要限制 ⚠️

| 会跟踪 ✅ | 不会跟踪 ❌ |
|----------|------------|
| Claude 通过编辑工具修改的文件 | Bash 命令（`rm`、`mv`、`cp`） |
| 当前会话内的修改 | 外部工具（VS Code、终端）的修改 |

```bash
# ❌ 无法通过 checkpoint 回滚
! rm -rf dist/           # Bash 删除
! mv old.js new.js       # Bash 移动

# ✅ 可以回滚
"帮我修改 auth.js"       # Claude 编辑工具
```

#### Checkpoint vs Git

| 特性 | Checkpoint | Git |
|------|------------|-----|
| 创建方式 | 自动（每次对话） | 手动 commit |
| 回滚速度 | 秒级 | 需手动操作 |
| AI 记忆 | ✅ 同步回滚 | ❌ 只回滚代码 |
| 持久性 | 30 天后清理 | 永久保存 |

**最佳实践**：两者配合使用
```bash
# 开始新功能 → Git 存档
git commit -m "开始做用户偏好设置"

# Claude 干活（自动创建 checkpoints）

# 中途改坏了 → Checkpoint 快速回滚
/rewind

# 功能完成 → Git 存档
git commit -m "完成用户偏好设置"
```

### Extended Thinking 扩展思考 ⭐

**是什么**：让 Claude "想得更久"，展示完整推理过程，适合复杂任务

**如何触发**：
```bash
# 方法一：按 Tab 键切换

# 方法二：在提示词中使用关键词
think              # ~1,500 tokens，5-10秒
think hard         # ~3,000 tokens，10-20秒
think harder       # ~8,000 tokens，20-30秒
ultrathink         # ~16,000 tokens，30-60秒
```

**使用场景**：
```bash
# 一般分析
"think about how to optimize this database query"

# 复杂推理
"think hard about the authentication system architecture"

# 架构决策
"ultrathink this microservice migration strategy"
```

> [!tip] 建议
> 简单语法查询无需开启扩展思考，避免浪费 Token

### CLAUDE.md 项目记忆文件

**是什么**：项目级别的"说明书"，Claude 每次启动都会自动读取

**如何创建**：
```bash
/init    # 自动分析项目并生成 CLAUDE.md
```

**文件结构示例**：
```markdown
# 项目说明
- 技术栈：React + TypeScript
- 包管理器：pnpm

## 代码规范
- 使用 ES modules
- 函数命名：camelCase
- 组件命名：PascalCase

## 测试要求
- 单元测试：Jest
- 覆盖率 > 80%

## Git 工作流
- 分支命名：feature/功能名
- 提交信息：中文描述
```

**记忆文件层级**：
| 位置 | 作用范围 |
|------|----------|
| `~/.claude/CLAUDE.md` | 全局（所有项目） |
| `./CLAUDE.md` | 项目级 |
| `./CLAUDE.local.md` | 本地（不提交 Git） |

## 操作步骤

### 基本工作流

#### 修复 Bug
```bash
# 1. 描述问题
"登录功能报错，错误信息是 'Invalid token'"

# 2. Claude 会自动
# - 读取相关代码
# - 分析问题
# - 提出修复方案
# - 实施修复

# 3. 验证
"运行测试确保修复有效"
```

#### 添加新功能
```bash
# 1. 进入规划模式
/plan

# 2. Claude 分析
# - 探索代码库
# - 设计方案
# - 提交计划

# 3. 确认后执行
"按照计划实现"

# 4. 提交更改
/commit
```

#### 代码审查
```bash
# 方式一：使用命令
/review-pr 123

# 方式二：直接贴代码
"帮我审查这段代码的质量"
```

### Slash 命令速查

**基础操作**：
| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/help` | 显示所有可用命令 | 查看帮助信息 |
| `/clear` | 清空对话历史 | 切换到全新任务 |
| `/compact` | 压缩对话，保留摘要 | 对话太长时节省 Token |
| `/exit` | 退出 Claude Code | 结束工作 |

**项目与上下文**：
| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/init` | 生成 CLAUDE.md 项目文档 | 新项目首次接入 |
| `/memory` | 编辑项目记忆文件 | 修改项目规则 |
| `/context` | 可视化上下文占用 | 检查"脑容量"使用 |
| `/add-dir <路径>` | 添加额外工作目录 | 多模块项目 |
| `/resume` | 恢复之前的会话 | 继续中断的任务 |

**代码与 Git**：
| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/commit` | 创建 git commit | 提交代码变更 |
| `/review` | 审查当前代码变更 | 代码审查 |
| `/review-pr` | 审查 Pull Request | PR 代码审查 |
| `/rewind` | 回滚到之前状态 | 撤销 AI 的错误修改 |

**系统与监控**：
| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/cost` | 查看 Token 和费用 | 成本控制 |
| `/status` | 查看模型和账户状态 | 检查配置 |
| `/doctor` | 系统诊断 | 排查问题 |
| `/model` | 切换 AI 模型 | 更换模型 |
| `/permissions` | 权限管理 | 控制操作需确认 |

**高级功能**：
| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/plan` | 进入规划模式 | 复杂任务预先规划 |
| `/agents` | 管理后台子智能体 | 并行任务 |
| `/mcp` | 管理 MCP 服务 | 扩展能力 |
| `/hooks` | 管理事件钩子 | 自动化流程 |

## 注意事项 ⚠️

### 常见错误

**文件操作失败**：
- ❌ 没有指定明确路径
- ❌ 文件权限不足
- ❌ 路径格式错误

**搜索无结果**：
- ❌ 搜索模式不准确
- ❌ 文件扩展名不匹配
- ❌ 关键词拼写错误

**Git 提交问题**：
- ❌ 没有未暂存的更改
- ❌ 提交信息格式不正确
- ❌ 忽略了敏感文件

### 关键配置点

**提供清晰上下文**：
```bash
# ❌ 不够清晰
"修复这个文件"

# ✅ 清晰明确
"修复 auth.js 中的登录 bug，错误信息是 'Invalid token'"
```

**使用 Plan Mode**：
- ✅ 添加新功能
- ✅ 重构现有代码
- ✅ 修改多个文件的架构
- ✅ 有多种实现方案的任务

**充分利用 Git 集成**：
- 让 Claude 帮你管理提交
- 自动分析变更
- 生成合适的 commit 消息

## 常见问题 ❓

**Q: 如何查看当前使用的模型？**

A: 在 Claude Code 会话中询问："我当前使用的是什么模型？"

**Q: Plan Mode 什么时候用？**

A: 复杂、多步骤的任务，比如：
- 添加新功能
- 重构代码
- 修改架构
- 有多种实现方案时

**Q: 如何让 Claude 记住项目信息？**

A: 使用 `/remember` 命令保存项目上下文，Claude 会记住项目的特殊配置和约定。

**Q: Claude 能同时处理多个任务吗？**

A: 可以。Claude 可以并行执行独立任务，比如同时搜索多个不相关的话题。

**Q: 如何中断当前操作？**

A: 按 `Ctrl+C` 停止当前操作。

---

## 概念辨析 📖

### `/clear` vs `/compact` vs `/rewind`

| 命令 | 效果 | 使用场景 |
|------|------|----------|
| `/clear` | **完全清空**对话历史 | 切换到完全不同的任务 |
| `/compact` | **压缩**对话，保留摘要 | 想继续当前任务但对话太长 |
| `/rewind` | **回滚**到历史状态 | 撤销代码修改或重置对话方向 |

**通俗理解**：
- `/clear` = 换一个新牛马，没有任何记忆
- `/compact` = 让牛马"整理笔记"，删掉废话保留重点
- `/rewind` = 时光机，回到过去某个时间点

### Checkpoint vs Git

| 特性 | Checkpoint | Git |
|------|------------|-----|
| **用途** | 会话内实验 | 正式存档 |
| **创建** | 自动 | 手动 commit |
| **回滚** | 代码 + AI记忆 | 仅代码 |
| **持久性** | 30天清理 | 永久保存 |

**最佳实践**：两者配合
- Checkpoint → 快速试错、临时回滚
- Git → 里程碑存档、长期历史

### 什么是"上下文"？

**通俗理解**：Claude 的"脑容量"是有限的（200K tokens）

- 对话历史、读取的文件、系统提示都占用"脑容量"
- 用 `/context` 可以查看占用情况
- 占用太多时 Claude 会"变笨"，需要 `/compact` 或 `/clear`

```
┌─────────────────────────────────────────┐
│           Claude 脑容量 (200K)           │
├─────────────────────────────────────────┤
│ ████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░ │
│   已用 60K (30%)    剩余 140K (70%)      │
│                                         │
│   📄 对话历史: 40K                       │
│   📁 读取的文件: 15K                     │
│   ⚙️ 系统提示: 5K                        │
└─────────────────────────────────────────┘
```

## 相关文档
[[02-工具使用/如何使用Claude code]] | [[01-基础概念/Skills 是什么]] | [[01-基础概念/人工智能重要的六大概念体系]]
