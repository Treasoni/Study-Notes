
#linux 
# 1. Linux服务器的磁盘
我们在进行linux服务器搭建的时候，我们的硬盘经常是这样的情况：

```text
硬盘 sda        200G
├─ sda2         2G        → /boot
└─ sda3         198G      → LVM 物理卷（PV）
    └─ ubuntu-vg
        └─ ubuntu-lv     99G → /
```
关键点在这里 👇
>- sda3：198G
>- / 实际用的 ubuntu-lv：99G

👉 中间差的 ~99G：
>- 已经在 Volume Group（VG）里
>- 但 没有分配给 Logical Volume（LV）

## 1.1 为什么会这样？（不是你装错）

这是 **Ubuntu 安装器的“保守默认行为”**：

- 使用 LVM
- **只给 `/` 分一半空间**
- 留一半：
    - 方便以后加 `/home`
    - 或快照
    - 或扩容
👉 服务器上这是**好习惯**，但你现在想全用，那就扩。
# 2. 名词概念讲解
- **LVM 是一套“磁盘管理体系”**
- **VG 是 LVM 里的“空间仓库 / 池子”**

一句顺口溜版：

> **LVM 管钱，VG 存钱，LV 花钱**

记住这句，后面全通。
## 2.1 为什么会有 LVM？

在 **没有 LVM** 的年代：
>- 一块盘分好区（/、/home、/data）
>- `/` 分小了 👉 **完蛋**
>- 想扩容 👉 **重装 / 挪数据 / 高风险**

服务器一多，这种方式直接崩。

👉 **LVM 就是为了解决“以后还能随便改大小”这个问题**

## 2.2 LVM 是什么？（从“人话”讲）

**官方名：**

**LVM = Logical Volume Manager（逻辑卷管理器）**

 **人话版：**

> **LVM 是一个“把硬盘空间池化、可随时切割和扩容”的系统**

它让你做到：

>- 不一次性决定分区大小
>- 空间用完了可以随时加
>- 不用重装系统

## 2.3 LVM 的 3 个核心角色（重点）

LVM 就 3 个东西，你全搞懂就毕业了：

`PV → VG → LV`

我们一个一个拆。

### 2.3.1  PV 是什么？（Physical Volume）

**官方：**

**物理卷**

**人话：**

> **被 LVM 接管的“原材料硬盘空间”**

比如你现在：

`/dev/sda3  →  PV`

意思是：

- `/dev/sda3` 不再直接用
- 我把它交给 LVM 管

👉 就像：

> 把现金存进银行

### 2.3.2  VG 是什么？（Volume Group）🔥重点🔥

**官方：**

**卷组**

**人话（非常重要）：**

> **一个“统一的空间仓库 / 池子”**

你的机器里有：

`VG 名字：ubuntu-vg 总容量：≈ 198G`

VG 的本质是：

- 把多个 PV 合并
- 形成一个“可分配的空间池”

👉 类比：

`硬盘 / 分区 → 存进仓库（VG）`

##### VG 有啥用？

>- 不直接存文件
>- 不挂载
>- 只负责 **“给谁分多少空间”**

### 2.3.3 LV 是什么？（Logical Volume）

**官方：**

**逻辑卷**

**人话：**

> **真正能格式化、挂载、被系统用的“假分区”**

你现在有：

`LV：ubuntu-lv 大小：99G 挂载点：/`

👉 对系统来说：

- LV ≈ 分区
- `/dev/ubuntu-vg/ubuntu-lv` ≈ `/dev/sdaX`
## 2.4 再用一个超好记的类比（强烈推荐）

**银行类比（秒懂版）**

|LVM 组件|类比|
|---|---|
|硬盘 / 分区|现金|
|**PV**|存进银行|
|**VG**|银行账户|
|**LV**|银行卡|
|`/`|你刷的那张卡|

👉 你现在是：

- 账户里有 198G
- 卡里只有 99G
- 剩下的钱还没转到卡上
你现在真实结构是：
```text
硬盘 sda（200G）
 └─ sda3（198G）
     ↓
   PV（物理卷）
     ↓
   VG：ubuntu-vg（≈198G）
     ├─ LV：ubuntu-lv（99G） → /
     └─ 剩余空间（≈100G）   ← 闲着

```

这就是那句：

> **100G 在 LVM 里，但没分配给 /**
# 3. 理论讲解
## 3..1 从你的 `lsblk` 结果开始逐层拆

你现在的盘是这样的 👇

```text
sda        200G   ← 整块硬盘
├─sda1       1M
├─sda2       2G   → /boot
└─sda3     198G   → LVM 物理卷（PV）
    └─ubuntu-vg-ubuntu-lv  99G  → /

```

我们按 **“从外到内”** 的顺序来。

### 3.1.1 第 1 层：物理硬盘（Physical Disk）

`sda = 200G`

这是**实打实的 200G 硬盘**，没问题。

### 3.1.2 第 2 层：分区（Partition）

`sda3 = 198G`

这里非常关键的一点：

> **你的 200G 硬盘，已经几乎全部给了 LVM（sda3）**

所以👇  
❌ **问题不在“没分区”**  
❌ **也不在“PVE / Ubuntu 只认 100G”**

##3w 3.1.3 第 3 层：LVM 的第一步 —— PV（物理卷）

`sda3` 并不是直接挂载的，而是：

`sda3 → LVM Physical Volume (PV)`

这一步的含义是：

> **我把一整块分区，交给 LVM 统一管理**

就像：

- 把 198G 现金
    
- 全部存进银行（LVM）
    
- 不再直接揣在兜里用
    

---

## 六、第 4 层：VG（卷组）—— LVM 的“仓库”

在 LVM 里：

`PV(sda3 198G)   ↓ VG(ubuntu-vg)`

**VG = Volume Group（卷组）**

你可以把它理解为：

> **一个“总仓库”，里面有大约 198G 可用空间**

⚠️ 注意：

- **VG ≠ 文件系统**
    
- **VG 不能直接用**
    
- 它只是“空间池”
    

---

## 七、第 5 层：LV（逻辑卷）—— 真正能用的“分区”

`ubuntu-vg └─ ubuntu-lv 99G → /`

这一步发生了什么？

> **你从 198G 的仓库里，只拿了 99G，做成了一个 LV，并挂载为 `/`**

于是就出现了你看到的现象：

- 仓库里：≈ 198G
    
- `/` 实际用的：99G
    
- **剩下 ≈ 100G：还在仓库里，没人用**