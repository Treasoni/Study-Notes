
#linux 
# 1. LinuxæœåŠ¡å™¨çš„ç£ç›˜
æˆ‘ä»¬åœ¨è¿›è¡ŒlinuxæœåŠ¡å™¨æ­å»ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç¡¬ç›˜ç»å¸¸æ˜¯è¿™æ ·çš„æƒ…å†µï¼š

```text
ç¡¬ç›˜ sda        200G
â”œâ”€ sda2         2G        â†’ /boot
â””â”€ sda3         198G      â†’ LVM ç‰©ç†å·ï¼ˆPVï¼‰
    â””â”€ ubuntu-vg
        â””â”€ ubuntu-lv     99G â†’ /
```
å…³é”®ç‚¹åœ¨è¿™é‡Œ ğŸ‘‡
>- sda3ï¼š198G
>- / å®é™…ç”¨çš„ ubuntu-lvï¼š99G

ğŸ‘‰ ä¸­é—´å·®çš„ ~99Gï¼š
>- å·²ç»åœ¨ Volume Groupï¼ˆVGï¼‰é‡Œ
>- ä½† æ²¡æœ‰åˆ†é…ç»™ Logical Volumeï¼ˆLVï¼‰

## 1.1 ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿï¼ˆä¸æ˜¯ä½ è£…é”™ï¼‰

è¿™æ˜¯ **Ubuntu å®‰è£…å™¨çš„â€œä¿å®ˆé»˜è®¤è¡Œä¸ºâ€**ï¼š

- ä½¿ç”¨ LVM
- **åªç»™ `/` åˆ†ä¸€åŠç©ºé—´**
- ç•™ä¸€åŠï¼š
    - æ–¹ä¾¿ä»¥ååŠ  `/home`
    - æˆ–å¿«ç…§
    - æˆ–æ‰©å®¹
ğŸ‘‰ æœåŠ¡å™¨ä¸Šè¿™æ˜¯**å¥½ä¹ æƒ¯**ï¼Œä½†ä½ ç°åœ¨æƒ³å…¨ç”¨ï¼Œé‚£å°±æ‰©ã€‚
# 2. åè¯æ¦‚å¿µè®²è§£
- **LVM æ˜¯ä¸€å¥—â€œç£ç›˜ç®¡ç†ä½“ç³»â€**
- **VG æ˜¯ LVM é‡Œçš„â€œç©ºé—´ä»“åº“ / æ± å­â€**

ä¸€å¥é¡ºå£æºœç‰ˆï¼š

> **LVM ç®¡é’±ï¼ŒVG å­˜é’±ï¼ŒLV èŠ±é’±**

è®°ä½è¿™å¥ï¼Œåé¢å…¨é€šã€‚
## 2.1 ä¸ºä»€ä¹ˆä¼šæœ‰ LVMï¼Ÿ

åœ¨ **æ²¡æœ‰ LVM** çš„å¹´ä»£ï¼š
>- ä¸€å—ç›˜åˆ†å¥½åŒºï¼ˆ/ã€/homeã€/dataï¼‰
>- `/` åˆ†å°äº† ğŸ‘‰ **å®Œè›‹**
>- æƒ³æ‰©å®¹ ğŸ‘‰ **é‡è£… / æŒªæ•°æ® / é«˜é£é™©**

æœåŠ¡å™¨ä¸€å¤šï¼Œè¿™ç§æ–¹å¼ç›´æ¥å´©ã€‚

ğŸ‘‰ **LVM å°±æ˜¯ä¸ºäº†è§£å†³â€œä»¥åè¿˜èƒ½éšä¾¿æ”¹å¤§å°â€è¿™ä¸ªé—®é¢˜**

## 2.2 LVM æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä»â€œäººè¯â€è®²ï¼‰

**å®˜æ–¹åï¼š**

**LVM = Logical Volume Managerï¼ˆé€»è¾‘å·ç®¡ç†å™¨ï¼‰**

 **äººè¯ç‰ˆï¼š**

> **LVM æ˜¯ä¸€ä¸ªâ€œæŠŠç¡¬ç›˜ç©ºé—´æ± åŒ–ã€å¯éšæ—¶åˆ‡å‰²å’Œæ‰©å®¹â€çš„ç³»ç»Ÿ**

å®ƒè®©ä½ åšåˆ°ï¼š

>- ä¸ä¸€æ¬¡æ€§å†³å®šåˆ†åŒºå¤§å°
>- ç©ºé—´ç”¨å®Œäº†å¯ä»¥éšæ—¶åŠ 
>- ä¸ç”¨é‡è£…ç³»ç»Ÿ

## 2.3 LVM çš„ 3 ä¸ªæ ¸å¿ƒè§’è‰²ï¼ˆé‡ç‚¹ï¼‰

LVM å°± 3 ä¸ªä¸œè¥¿ï¼Œä½ å…¨ææ‡‚å°±æ¯•ä¸šäº†ï¼š

`PV â†’ VG â†’ LV`

æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ‹†ã€‚

### 2.3.1  PV æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆPhysical Volumeï¼‰

**å®˜æ–¹ï¼š**

**ç‰©ç†å·**

**äººè¯ï¼š**

> **è¢« LVM æ¥ç®¡çš„â€œåŸææ–™ç¡¬ç›˜ç©ºé—´â€**

æ¯”å¦‚ä½ ç°åœ¨ï¼š

`/dev/sda3  â†’  PV`

æ„æ€æ˜¯ï¼š

- `/dev/sda3` ä¸å†ç›´æ¥ç”¨
- æˆ‘æŠŠå®ƒäº¤ç»™ LVM ç®¡

ğŸ‘‰ å°±åƒï¼š

> æŠŠç°é‡‘å­˜è¿›é“¶è¡Œ

### 2.3.2  VG æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆVolume Groupï¼‰ğŸ”¥é‡ç‚¹ğŸ”¥

**å®˜æ–¹ï¼š**

**å·ç»„**

**äººè¯ï¼ˆéå¸¸é‡è¦ï¼‰ï¼š**

> **ä¸€ä¸ªâ€œç»Ÿä¸€çš„ç©ºé—´ä»“åº“ / æ± å­â€**

ä½ çš„æœºå™¨é‡Œæœ‰ï¼š

`VG åå­—ï¼šubuntu-vg æ€»å®¹é‡ï¼šâ‰ˆ 198G`

VG çš„æœ¬è´¨æ˜¯ï¼š

- æŠŠå¤šä¸ª PV åˆå¹¶
- å½¢æˆä¸€ä¸ªâ€œå¯åˆ†é…çš„ç©ºé—´æ± â€

ğŸ‘‰ ç±»æ¯”ï¼š

`ç¡¬ç›˜ / åˆ†åŒº â†’ å­˜è¿›ä»“åº“ï¼ˆVGï¼‰`

##### VG æœ‰å•¥ç”¨ï¼Ÿ

>- ä¸ç›´æ¥å­˜æ–‡ä»¶
>- ä¸æŒ‚è½½
>- åªè´Ÿè´£ **â€œç»™è°åˆ†å¤šå°‘ç©ºé—´â€**

### 2.3.3 LV æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆLogical Volumeï¼‰

**å®˜æ–¹ï¼š**

**é€»è¾‘å·**

**äººè¯ï¼š**

> **çœŸæ­£èƒ½æ ¼å¼åŒ–ã€æŒ‚è½½ã€è¢«ç³»ç»Ÿç”¨çš„â€œå‡åˆ†åŒºâ€**

ä½ ç°åœ¨æœ‰ï¼š

`LVï¼šubuntu-lv å¤§å°ï¼š99G æŒ‚è½½ç‚¹ï¼š/`

ğŸ‘‰ å¯¹ç³»ç»Ÿæ¥è¯´ï¼š

- LV â‰ˆ åˆ†åŒº
- `/dev/ubuntu-vg/ubuntu-lv` â‰ˆ `/dev/sdaX`
## 2.4 å†ç”¨ä¸€ä¸ªè¶…å¥½è®°çš„ç±»æ¯”ï¼ˆå¼ºçƒˆæ¨èï¼‰

**é“¶è¡Œç±»æ¯”ï¼ˆç§’æ‡‚ç‰ˆï¼‰**

|LVM ç»„ä»¶|ç±»æ¯”|
|---|---|
|ç¡¬ç›˜ / åˆ†åŒº|ç°é‡‘|
|**PV**|å­˜è¿›é“¶è¡Œ|
|**VG**|é“¶è¡Œè´¦æˆ·|
|**LV**|é“¶è¡Œå¡|
|`/`|ä½ åˆ·çš„é‚£å¼ å¡|

ğŸ‘‰ ä½ ç°åœ¨æ˜¯ï¼š

- è´¦æˆ·é‡Œæœ‰ 198G
- å¡é‡Œåªæœ‰ 99G
- å‰©ä¸‹çš„é’±è¿˜æ²¡è½¬åˆ°å¡ä¸Š
ä½ ç°åœ¨çœŸå®ç»“æ„æ˜¯ï¼š
```text
ç¡¬ç›˜ sdaï¼ˆ200Gï¼‰
 â””â”€ sda3ï¼ˆ198Gï¼‰
     â†“
   PVï¼ˆç‰©ç†å·ï¼‰
     â†“
   VGï¼šubuntu-vgï¼ˆâ‰ˆ198Gï¼‰
     â”œâ”€ LVï¼šubuntu-lvï¼ˆ99Gï¼‰ â†’ /
     â””â”€ å‰©ä½™ç©ºé—´ï¼ˆâ‰ˆ100Gï¼‰   â† é—²ç€

```

è¿™å°±æ˜¯é‚£å¥ï¼š

> **100G åœ¨ LVM é‡Œï¼Œä½†æ²¡åˆ†é…ç»™ /**
# 3. ç†è®ºè®²è§£
## 3..1 ä»ä½ çš„ `lsblk` ç»“æœå¼€å§‹é€å±‚æ‹†

ä½ ç°åœ¨çš„ç›˜æ˜¯è¿™æ ·çš„ ğŸ‘‡

```text
sda        200G   â† æ•´å—ç¡¬ç›˜
â”œâ”€sda1       1M
â”œâ”€sda2       2G   â†’ /boot
â””â”€sda3     198G   â†’ LVM ç‰©ç†å·ï¼ˆPVï¼‰
    â””â”€ubuntu-vg-ubuntu-lv  99G  â†’ /

```

æˆ‘ä»¬æŒ‰ **â€œä»å¤–åˆ°å†…â€** çš„é¡ºåºæ¥ã€‚

### 3.1.1 ç¬¬ 1 å±‚ï¼šç‰©ç†ç¡¬ç›˜ï¼ˆPhysical Diskï¼‰

`sda = 200G`

è¿™æ˜¯**å®æ‰“å®çš„ 200G ç¡¬ç›˜**ï¼Œæ²¡é—®é¢˜ã€‚

### 3.1.2 ç¬¬ 2 å±‚ï¼šåˆ†åŒºï¼ˆPartitionï¼‰

`sda3 = 198G`

è¿™é‡Œéå¸¸å…³é”®çš„ä¸€ç‚¹ï¼š

> **ä½ çš„ 200G ç¡¬ç›˜ï¼Œå·²ç»å‡ ä¹å…¨éƒ¨ç»™äº† LVMï¼ˆsda3ï¼‰**

æ‰€ä»¥ğŸ‘‡  
âŒ **é—®é¢˜ä¸åœ¨â€œæ²¡åˆ†åŒºâ€**  
âŒ **ä¹Ÿä¸åœ¨â€œPVE / Ubuntu åªè®¤ 100Gâ€**

### 3.1.3 ç¬¬ 3 å±‚ï¼šLVM çš„ç¬¬ä¸€æ­¥ â€”â€” PVï¼ˆç‰©ç†å·ï¼‰

`sda3` å¹¶ä¸æ˜¯ç›´æ¥æŒ‚è½½çš„ï¼Œè€Œæ˜¯ï¼š

`sda3 â†’ LVM Physical Volume (PV)`

è¿™ä¸€æ­¥çš„å«ä¹‰æ˜¯ï¼š

> **æˆ‘æŠŠä¸€æ•´å—åˆ†åŒºï¼Œäº¤ç»™ LVM ç»Ÿä¸€ç®¡ç†**

å°±åƒï¼š

>- æŠŠ 198G ç°é‡‘
>- å…¨éƒ¨å­˜è¿›é“¶è¡Œï¼ˆLVMï¼‰
>- ä¸å†ç›´æ¥æ£åœ¨å…œé‡Œç”¨


### 3.1.4 ç¬¬ 4 å±‚ï¼šVGï¼ˆå·ç»„ï¼‰â€”â€” LVM çš„â€œä»“åº“â€

åœ¨ LVM é‡Œï¼š

`PV(sda3 198G)   â†“ VG(ubuntu-vg)`

**VG = Volume Groupï¼ˆå·ç»„ï¼‰**

ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼š

> **ä¸€ä¸ªâ€œæ€»ä»“åº“â€ï¼Œé‡Œé¢æœ‰å¤§çº¦ 198G å¯ç”¨ç©ºé—´**

âš ï¸ æ³¨æ„ï¼š

>- **VG â‰  æ–‡ä»¶ç³»ç»Ÿ**
>- **VG ä¸èƒ½ç›´æ¥ç”¨**
>- å®ƒåªæ˜¯â€œç©ºé—´æ± â€

### 3.1.5 ç¬¬ 5 å±‚ï¼šLVï¼ˆé€»è¾‘å·ï¼‰â€”â€” çœŸæ­£èƒ½ç”¨çš„â€œåˆ†åŒºâ€

`ubuntu-vg â””â”€ ubuntu-lv 99G â†’ /`

è¿™ä¸€æ­¥å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

> **ä½ ä» 198G çš„ä»“åº“é‡Œï¼Œåªæ‹¿äº† 99Gï¼Œåšæˆäº†ä¸€ä¸ª LVï¼Œå¹¶æŒ‚è½½ä¸º `/`**

äºæ˜¯å°±å‡ºç°äº†ä½ çœ‹åˆ°çš„ç°è±¡ï¼š

- ä»“åº“é‡Œï¼šâ‰ˆ 198G
- `/` å®é™…ç”¨çš„ï¼š99G
- **å‰©ä¸‹ â‰ˆ 100Gï¼šè¿˜åœ¨ä»“åº“é‡Œï¼Œæ²¡äººç”¨**

# 4. æ–°å¢çš„ç¡¬ç›˜å¦‚ä½•æ“ä½œï¼Ÿ

> **åœ¨ä½¿ç”¨ LVM çš„ Linux é‡Œï¼Œæ–°å¢ç¡¬ç›˜ = æŠŠæ–°ç¡¬ç›˜åŠ å…¥ VGï¼Œç„¶åå†åˆ†é…ç»™æŸä¸ª LV**

å£è¯€ç‰ˆï¼ˆéå¸¸é‡è¦ï¼‰ğŸ‘‡ï¼š

`æ–°ç¡¬ç›˜ â†’ PV â†’ åŠ å…¥ VG â†’ æ‰© LV â†’ æ‰©æ–‡ä»¶ç³»ç»Ÿ`

ä½ ä»¥ååªè¦è®°ä½è¿™ 5 æ­¥ï¼Œå°±ä¸ä¼šæ…Œã€‚`
# 4.1 ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ç³»ç»Ÿè®¤åˆ°æ–°ç¡¬ç›˜

```bash
lsblk
```

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š

`sda   200G sdb   200G   â† æ–°ç›˜`

ğŸ‘‰ çœ‹ä¸åˆ°ï¼Ÿ

>- è™šæ‹Ÿæœºï¼šæ²¡æ·»åŠ 
>- å®ä½“æœºï¼šBIOS / çƒ­æ’æ‹”é—®é¢˜

##  4.2 ç¬¬ 2 æ­¥ï¼šç»™æ–°ç¡¬ç›˜åˆ†åŒºï¼ˆä¸€æ¬¡æ€§ç»™ LVMï¼‰
å…·ä½“æ•™å­¦å¯ä»¥çœ‹[æ·»åŠ ä¸€ä¸ªç¡¬ç›˜çš„æµç¨‹](linuxç£ç›˜ç›¸å…³çš„çŸ¥è¯†.md#æ·»åŠ ä¸€ä¸ªç¡¬ç›˜çš„æµç¨‹)

```bash
sudo fdisk /dev/sdb
```

**æ ‡å‡†æ“ä½œï¼š**

```bash
n   ï¼ˆæ–°å»ºåˆ†åŒºï¼‰
p   ï¼ˆä¸»åˆ†åŒºï¼‰
å›è½¦ å›è½¦ å›è½¦ï¼ˆç”¨æ•´å—ç›˜ï¼‰
t   ï¼ˆä¿®æ”¹ç±»å‹ï¼‰
8e  ï¼ˆLinux LVMï¼‰
w   ï¼ˆå†™å…¥ï¼‰

```

ç„¶ååˆ·æ–°ï¼š

```bash
sudo partprobe
```

ç°åœ¨ä½ ä¼šå¾—åˆ°ï¼š

`/dev/sdb1`

## 4.3 ç¬¬ 3 æ­¥ï¼šæŠŠæ–°åˆ†åŒºå˜æˆ PVï¼ˆäº¤ç»™ LVMï¼‰

```bash
sudo pvcreate /dev/sdb1
```

éªŒè¯ï¼š

```bash
pvs
```
ä½ ä¼šçœ‹åˆ°ï¼š

```bash
/dev/sda3   ubuntu-vg
/dev/sdb1   ubuntu-vg  ï¼ˆè¿˜æ²¡åŠ å…¥ï¼‰
```

## 4.4 ç¬¬ 4 æ­¥ï¼šæŠŠæ–° PV åŠ å…¥ VGï¼ˆå…³é”®ä¸€æ­¥ï¼‰

```bash
sudo vgextend ubuntu-vg /dev/sdb1
```

æŸ¥çœ‹ï¼š

```bash
vgs
```

æ­¤æ—¶ï¼š

```bash
VG        VSize   VFree
ubuntu-vg 398G    200G
```

ğŸ‘‰ **VG å°±å˜å¤§äº†**

## 4.5 ç¬¬ 5 æ­¥ï¼šæŠŠç©ºé—´åˆ†é…ç»™æŸä¸ª LV

### æƒ…å†µ 1ï¸âƒ£ï¼šå…¨éƒ¨æ‰©ç»™æ ¹ç›®å½• `/`

```bash
sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv

```
### æƒ…å†µ 2ï¸âƒ£ï¼šåªåŠ  100G

```bash
sudo lvextend -L +100G /dev/ubuntu-vg/ubuntu-lv
```

## 4.6 ç¬¬ 6 æ­¥ï¼šæ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆéå¸¸é‡è¦ï¼‰

### å¦‚æœæ˜¯ ext4ï¼ˆUbuntu é»˜è®¤ï¼‰

```bash
sudo resize2fs /dev/ubuntu-vg/ubuntu-lv

```
### å¦‚æœæ˜¯ xfsï¼ˆå¸¸è§äºæœåŠ¡å™¨ï¼‰

```bash
sudo xfs_growfs /
```

## 4.7 ç¬¬ 7 æ­¥ï¼šç¡®è®¤æˆåŠŸ

```bash
df -h
```

ä½ ä¼šçœ‹åˆ°ï¼š

```bash
/   398G
```

ğŸ‰ **å®Œæˆï¼Œå…¨ç¨‹ä¸åœæœº**
