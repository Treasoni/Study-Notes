
# linux
# 1. LinuxæœåŠ¡å™¨çš„ç£ç›˜
æˆ‘ä»¬åœ¨è¿›è¡ŒlinuxæœåŠ¡å™¨æ­å»ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç¡¬ç›˜ç»å¸¸æ˜¯è¿™æ ·çš„æƒ…å†µï¼š

```text
ç¡¬ç›˜ sda        200G
â”œâ”€ sda2         2G        â†’ /boot
â””â”€ sda3         198G      â†’ LVM ç‰©ç†å·ï¼ˆPVï¼‰
    â””â”€ ubuntu-vg
        â””â”€ ubuntu-lv     99G â†’ /
```
å…³é”®ç‚¹åœ¨è¿™é‡Œ ğŸ‘‡
>- sda3ï¼š198G
>- / å®é™…ç”¨çš„ ubuntu-lvï¼š99G

ğŸ‘‰ ä¸­é—´å·®çš„ ~99Gï¼š
>- å·²ç»åœ¨ Volume Groupï¼ˆVGï¼‰é‡Œ
>- ä½† æ²¡æœ‰åˆ†é…ç»™ Logical Volumeï¼ˆLVï¼‰

## 1.1 ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿï¼ˆä¸æ˜¯ä½ è£…é”™ï¼‰

è¿™æ˜¯ **Ubuntu å®‰è£…å™¨çš„â€œä¿å®ˆé»˜è®¤è¡Œä¸ºâ€**ï¼š

- ä½¿ç”¨ LVM
- **åªç»™ `/` åˆ†ä¸€åŠç©ºé—´**
- ç•™ä¸€åŠï¼š
    - æ–¹ä¾¿ä»¥ååŠ  `/home`
    - æˆ–å¿«ç…§
    - æˆ–æ‰©å®¹
ğŸ‘‰ æœåŠ¡å™¨ä¸Šè¿™æ˜¯**å¥½ä¹ æƒ¯**ï¼Œä½†ä½ ç°åœ¨æƒ³å…¨ç”¨ï¼Œé‚£å°±æ‰©ã€‚
# 2. åè¯æ¦‚å¿µè®²è§£
- **LVM æ˜¯ä¸€å¥—â€œç£ç›˜ç®¡ç†ä½“ç³»â€**
- **VG æ˜¯ LVM é‡Œçš„â€œç©ºé—´ä»“åº“ / æ± å­â€**

ä¸€å¥é¡ºå£æºœç‰ˆï¼š

> **LVM ç®¡é’±ï¼ŒVG å­˜é’±ï¼ŒLV èŠ±é’±**

è®°ä½è¿™å¥ï¼Œåé¢å…¨é€šã€‚
## 2.1 ä¸ºä»€ä¹ˆä¼šæœ‰ LVMï¼Ÿ

åœ¨ **æ²¡æœ‰ LVM** çš„å¹´ä»£ï¼š
>- ä¸€å—ç›˜åˆ†å¥½åŒºï¼ˆ/ã€/homeã€/dataï¼‰
>- `/` åˆ†å°äº† ğŸ‘‰ **å®Œè›‹**
>- æƒ³æ‰©å®¹ ğŸ‘‰ **é‡è£… / æŒªæ•°æ® / é«˜é£é™©**

æœåŠ¡å™¨ä¸€å¤šï¼Œè¿™ç§æ–¹å¼ç›´æ¥å´©ã€‚

ğŸ‘‰ **LVM å°±æ˜¯ä¸ºäº†è§£å†³â€œä»¥åè¿˜èƒ½éšä¾¿æ”¹å¤§å°â€è¿™ä¸ªé—®é¢˜**

## 2.2 LVM æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä»â€œäººè¯â€è®²ï¼‰

**å®˜æ–¹åï¼š**

**LVM = Logical Volume Managerï¼ˆé€»è¾‘å·ç®¡ç†å™¨ï¼‰**

 **äººè¯ç‰ˆï¼š**

> **LVM æ˜¯ä¸€ä¸ªâ€œæŠŠç¡¬ç›˜ç©ºé—´æ± åŒ–ã€å¯éšæ—¶åˆ‡å‰²å’Œæ‰©å®¹â€çš„ç³»ç»Ÿ**

å®ƒè®©ä½ åšåˆ°ï¼š

>- ä¸ä¸€æ¬¡æ€§å†³å®šåˆ†åŒºå¤§å°
>- ç©ºé—´ç”¨å®Œäº†å¯ä»¥éšæ—¶åŠ 
>- ä¸ç”¨é‡è£…ç³»ç»Ÿ

## 2.3 LVM çš„ 3 ä¸ªæ ¸å¿ƒè§’è‰²ï¼ˆé‡ç‚¹ï¼‰

LVM å°± 3 ä¸ªä¸œè¥¿ï¼Œä½ å…¨ææ‡‚å°±æ¯•ä¸šäº†ï¼š

`PV â†’ VG â†’ LV`

æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ‹†ã€‚

### 2.3.1  PV æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆPhysical Volumeï¼‰

**å®˜æ–¹ï¼š**

**ç‰©ç†å·**

**äººè¯ï¼š**

> **è¢« LVM æ¥ç®¡çš„â€œåŸææ–™ç¡¬ç›˜ç©ºé—´â€**

æ¯”å¦‚ä½ ç°åœ¨ï¼š

`/dev/sda3  â†’  PV`

æ„æ€æ˜¯ï¼š

- `/dev/sda3` ä¸å†ç›´æ¥ç”¨
- æˆ‘æŠŠå®ƒäº¤ç»™ LVM ç®¡

ğŸ‘‰ å°±åƒï¼š

> æŠŠç°é‡‘å­˜è¿›é“¶è¡Œ

### 2.3.2  VG æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆVolume Groupï¼‰ğŸ”¥é‡ç‚¹ğŸ”¥

**å®˜æ–¹ï¼š**

**å·ç»„**

**äººè¯ï¼ˆéå¸¸é‡è¦ï¼‰ï¼š**

> **ä¸€ä¸ªâ€œç»Ÿä¸€çš„ç©ºé—´ä»“åº“ / æ± å­â€**

ä½ çš„æœºå™¨é‡Œæœ‰ï¼š

`VG åå­—ï¼šubuntu-vg æ€»å®¹é‡ï¼šâ‰ˆ 198G`

VG çš„æœ¬è´¨æ˜¯ï¼š

- æŠŠå¤šä¸ª PV åˆå¹¶
- å½¢æˆä¸€ä¸ªâ€œå¯åˆ†é…çš„ç©ºé—´æ± â€

ğŸ‘‰ ç±»æ¯”ï¼š

`ç¡¬ç›˜ / åˆ†åŒº â†’ å­˜è¿›ä»“åº“ï¼ˆVGï¼‰`

**VG æœ‰å•¥ç”¨ï¼Ÿ**

>- ä¸ç›´æ¥å­˜æ–‡ä»¶
>- ä¸æŒ‚è½½
>- åªè´Ÿè´£ **â€œç»™è°åˆ†å¤šå°‘ç©ºé—´â€**

### 2.3.3 LV æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆLogical Volumeï¼‰

**å®˜æ–¹ï¼š**

**é€»è¾‘å·**

**äººè¯ï¼š**

> **çœŸæ­£èƒ½æ ¼å¼åŒ–ã€æŒ‚è½½ã€è¢«ç³»ç»Ÿç”¨çš„â€œå‡åˆ†åŒºâ€**

ä½ ç°åœ¨æœ‰ï¼š

`LVï¼šubuntu-lv å¤§å°ï¼š99G æŒ‚è½½ç‚¹ï¼š/`

ğŸ‘‰ å¯¹ç³»ç»Ÿæ¥è¯´ï¼š

- LV â‰ˆ åˆ†åŒº
- `/dev/ubuntu-vg/ubuntu-lv` â‰ˆ `/dev/sdaX`
## 2.4 å†ç”¨ä¸€ä¸ªè¶…å¥½è®°çš„ç±»æ¯”ï¼ˆå¼ºçƒˆæ¨èï¼‰

**é“¶è¡Œç±»æ¯”ï¼ˆç§’æ‡‚ç‰ˆï¼‰**

|LVM ç»„ä»¶|ç±»æ¯”|
|---|---|
|ç¡¬ç›˜ / åˆ†åŒº|ç°é‡‘|
|**PV**|å­˜è¿›é“¶è¡Œ|
|**VG**|é“¶è¡Œè´¦æˆ·|
|**LV**|é“¶è¡Œå¡|
|`/`|ä½ åˆ·çš„é‚£å¼ å¡|

ğŸ‘‰ ä½ ç°åœ¨æ˜¯ï¼š

- è´¦æˆ·é‡Œæœ‰ 198G
- å¡é‡Œåªæœ‰ 99G
- å‰©ä¸‹çš„é’±è¿˜æ²¡è½¬åˆ°å¡ä¸Š
ä½ ç°åœ¨çœŸå®ç»“æ„æ˜¯ï¼š
```text
ç¡¬ç›˜ sdaï¼ˆ200Gï¼‰
 â””â”€ sda3ï¼ˆ198Gï¼‰
     â†“
   PVï¼ˆç‰©ç†å·ï¼‰
     â†“
   VGï¼šubuntu-vgï¼ˆâ‰ˆ198Gï¼‰
     â”œâ”€ LVï¼šubuntu-lvï¼ˆ99Gï¼‰ â†’ /
     â””â”€ å‰©ä½™ç©ºé—´ï¼ˆâ‰ˆ100Gï¼‰   â† é—²ç€

```

è¿™å°±æ˜¯é‚£å¥ï¼š

> **100G åœ¨ LVM é‡Œï¼Œä½†æ²¡åˆ†é…ç»™ /**
# 3. ç†è®ºè®²è§£
## 3.1 ä»ä½ çš„ `lsblk` ç»“æœå¼€å§‹é€å±‚æ‹†

ä½ ç°åœ¨çš„ç›˜æ˜¯è¿™æ ·çš„ ğŸ‘‡

```text
sda        200G   â† æ•´å—ç¡¬ç›˜
â”œâ”€sda1       1M
â”œâ”€sda2       2G   â†’ /boot
â””â”€sda3     198G   â†’ LVM ç‰©ç†å·ï¼ˆPVï¼‰
    â””â”€ubuntu-vg-ubuntu-lv  99G  â†’ /

```

æˆ‘ä»¬æŒ‰ **â€œä»å¤–åˆ°å†…â€** çš„é¡ºåºæ¥ã€‚

### 3.1.1 ç¬¬ 1 å±‚ï¼šç‰©ç†ç¡¬ç›˜ï¼ˆPhysical Diskï¼‰

`sda = 200G`

è¿™æ˜¯**å®æ‰“å®çš„ 200G ç¡¬ç›˜**ï¼Œæ²¡é—®é¢˜ã€‚

### 3.1.2 ç¬¬ 2 å±‚ï¼šåˆ†åŒºï¼ˆPartitionï¼‰

`sda3 = 198G`

è¿™é‡Œéå¸¸å…³é”®çš„ä¸€ç‚¹ï¼š

> **ä½ çš„ 200G ç¡¬ç›˜ï¼Œå·²ç»å‡ ä¹å…¨éƒ¨ç»™äº† LVMï¼ˆsda3ï¼‰**

æ‰€ä»¥ğŸ‘‡  
âŒ **é—®é¢˜ä¸åœ¨â€œæ²¡åˆ†åŒºâ€**  
âŒ **ä¹Ÿä¸åœ¨â€œPVE / Ubuntu åªè®¤ 100Gâ€**

### 3.1.3 ç¬¬ 3 å±‚ï¼šLVM çš„ç¬¬ä¸€æ­¥ â€”â€” PVï¼ˆç‰©ç†å·ï¼‰

`sda3` å¹¶ä¸æ˜¯ç›´æ¥æŒ‚è½½çš„ï¼Œè€Œæ˜¯ï¼š

`sda3 â†’ LVM Physical Volume (PV)`

è¿™ä¸€æ­¥çš„å«ä¹‰æ˜¯ï¼š

> **æˆ‘æŠŠä¸€æ•´å—åˆ†åŒºï¼Œäº¤ç»™ LVM ç»Ÿä¸€ç®¡ç†**

å°±åƒï¼š

>- æŠŠ 198G ç°é‡‘
>- å…¨éƒ¨å­˜è¿›é“¶è¡Œï¼ˆLVMï¼‰
>- ä¸å†ç›´æ¥æ£åœ¨å…œé‡Œç”¨


### 3.1.4 ç¬¬ 4 å±‚ï¼šVGï¼ˆå·ç»„ï¼‰â€”â€” LVM çš„â€œä»“åº“â€

åœ¨ LVM é‡Œï¼š

`PV(sda3 198G)   â†“ VG(ubuntu-vg)`

**VG = Volume Groupï¼ˆå·ç»„ï¼‰**

ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼š

> **ä¸€ä¸ªâ€œæ€»ä»“åº“â€ï¼Œé‡Œé¢æœ‰å¤§çº¦ 198G å¯ç”¨ç©ºé—´**

âš ï¸ æ³¨æ„ï¼š

>- **VG â‰  æ–‡ä»¶ç³»ç»Ÿ**
>- **VG ä¸èƒ½ç›´æ¥ç”¨**
>- å®ƒåªæ˜¯â€œç©ºé—´æ± â€

### 3.1.5 ç¬¬ 5 å±‚ï¼šLVï¼ˆé€»è¾‘å·ï¼‰â€”â€” çœŸæ­£èƒ½ç”¨çš„â€œåˆ†åŒºâ€

`ubuntu-vg â””â”€ ubuntu-lv 99G â†’ /`

è¿™ä¸€æ­¥å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

> **ä½ ä» 198G çš„ä»“åº“é‡Œï¼Œåªæ‹¿äº† 99Gï¼Œåšæˆäº†ä¸€ä¸ª LVï¼Œå¹¶æŒ‚è½½ä¸º `/`**

äºæ˜¯å°±å‡ºç°äº†ä½ çœ‹åˆ°çš„ç°è±¡ï¼š

- ä»“åº“é‡Œï¼šâ‰ˆ 198G
- `/` å®é™…ç”¨çš„ï¼š99G
- **å‰©ä¸‹ â‰ˆ 100Gï¼šè¿˜åœ¨ä»“åº“é‡Œï¼Œæ²¡äººç”¨**

# 4. æ–°å¢çš„ç¡¬ç›˜å¦‚ä½•æ“ä½œï¼Ÿ

> **åœ¨ä½¿ç”¨ LVM çš„ Linux é‡Œï¼Œæ–°å¢ç¡¬ç›˜ = æŠŠæ–°ç¡¬ç›˜åŠ å…¥ VGï¼Œç„¶åå†åˆ†é…ç»™æŸä¸ª LV**

å£è¯€ç‰ˆï¼ˆéå¸¸é‡è¦ï¼‰ğŸ‘‡ï¼š

`æ–°ç¡¬ç›˜ â†’ PV â†’ åŠ å…¥ VG â†’ æ‰© LV â†’ æ‰©æ–‡ä»¶ç³»ç»Ÿ`

ä½ ä»¥ååªè¦è®°ä½è¿™ 5 æ­¥ï¼Œå°±ä¸ä¼šæ…Œã€‚
## 4.1 ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ç³»ç»Ÿè®¤åˆ°æ–°ç¡¬ç›˜

```bash
lsblk
```

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š

`sda   200G sdb   200G   â† æ–°ç›˜`

ğŸ‘‰ çœ‹ä¸åˆ°ï¼Ÿ

>- è™šæ‹Ÿæœºï¼šæ²¡æ·»åŠ 
>- å®ä½“æœºï¼šBIOS / çƒ­æ’æ‹”é—®é¢˜

##  4.2 ç¬¬ 2 æ­¥ï¼šç»™æ–°ç¡¬ç›˜åˆ†åŒºï¼ˆä¸€æ¬¡æ€§ç»™ LVMï¼‰
å…·ä½“æ•™å­¦å¯ä»¥çœ‹[æ·»åŠ ä¸€ä¸ªç¡¬ç›˜çš„æµç¨‹](linuxç£ç›˜ç›¸å…³çš„çŸ¥è¯†.md#æ·»åŠ ä¸€ä¸ªç¡¬ç›˜çš„æµç¨‹)

```bash
sudo fdisk /dev/sdb
```

**æ ‡å‡†æ“ä½œï¼š**

```bash
n   ï¼ˆæ–°å»ºåˆ†åŒºï¼‰
p   ï¼ˆä¸»åˆ†åŒºï¼‰
å›è½¦ å›è½¦ å›è½¦ï¼ˆç”¨æ•´å—ç›˜ï¼‰
t   ï¼ˆä¿®æ”¹ç±»å‹ï¼‰
8e  ï¼ˆLinux LVMï¼‰
w   ï¼ˆå†™å…¥ï¼‰

```

ç„¶ååˆ·æ–°ï¼š

```bash
sudo partprobe
```

ç°åœ¨ä½ ä¼šå¾—åˆ°ï¼š

`/dev/sdb1`

## 4.3 ç¬¬ 3 æ­¥ï¼šæŠŠæ–°åˆ†åŒºå˜æˆ PVï¼ˆäº¤ç»™ LVMï¼‰

```bash
sudo pvcreate /dev/sdb1
```

éªŒè¯ï¼š

```bash
pvs
```
ä½ ä¼šçœ‹åˆ°ï¼š

```bash
/dev/sda3   ubuntu-vg
/dev/sdb1   ubuntu-vg  ï¼ˆè¿˜æ²¡åŠ å…¥ï¼‰
```

## 4.4 ç¬¬ 4 æ­¥ï¼šæŠŠæ–° PV åŠ å…¥ VGï¼ˆå…³é”®ä¸€æ­¥ï¼‰

```bash
sudo vgextend ubuntu-vg /dev/sdb1
```

æŸ¥çœ‹ï¼š

```bash
vgs
```

æ­¤æ—¶ï¼š

```bash
VG        VSize   VFree
ubuntu-vg 398G    200G
```

ğŸ‘‰ **VG å°±å˜å¤§äº†**

## 4.5 ç¬¬ 5 æ­¥ï¼šæŠŠç©ºé—´åˆ†é…ç»™æŸä¸ª LV

### æƒ…å†µ 1ï¸âƒ£ï¼šå…¨éƒ¨æ‰©ç»™æ ¹ç›®å½• `/`

```bash
sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv

```
### æƒ…å†µ 2ï¸âƒ£ï¼šåªåŠ  100G

```bash
sudo lvextend -L +100G /dev/ubuntu-vg/ubuntu-lv
```
### æ¨èçš„ä¸€æ­¥åˆ°ä½å†™æ³•ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰

```bash
sudo lvextend -L +100G -r /dev/ubuntu-vg/ubuntu-lv
```

ğŸ‘‰ `-r` = resize filesystem  
ğŸ‘‰ **é€»è¾‘å· + æ–‡ä»¶ç³»ç»Ÿä¸€èµ·æ‰©**
å¯ä»¥çœäº†ç¬¬6æ­¥ã€‚

## 4.6 ç¬¬ 6 æ­¥ï¼šæ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆéå¸¸é‡è¦ï¼‰

### å¦‚æœæ˜¯ ext4ï¼ˆUbuntu é»˜è®¤ï¼‰

```bash
sudo resize2fs /dev/ubuntu-vg/ubuntu-lv

```
### å¦‚æœæ˜¯ xfsï¼ˆå¸¸è§äºæœåŠ¡å™¨ï¼‰

```bash
sudo xfs_growfs /
```

## 4.7 ç¬¬ 7 æ­¥ï¼šç¡®è®¤æˆåŠŸ

```bash
df -h
```

ä½ ä¼šçœ‹åˆ°ï¼š

```bash
/   398G
```

ğŸ‰ **å®Œæˆï¼Œå…¨ç¨‹ä¸åœæœº**

# 5. LVM çš„ä¼˜ç¼ºç‚¹

## 5.1 ä¼˜ç‚¹

| ä¼˜ç‚¹ | è¯´æ˜ |
|------|------|
| **åœ¨çº¿æ‰©å®¹/ç¼©å®¹** | æ— éœ€åœæœºå³å¯è°ƒæ•´åˆ†åŒºå¤§å° |
| **å¤šç£ç›˜åˆå¹¶** | å¤šå—ç¡¬ç›˜å¯ä»¥åˆå¹¶æˆä¸€ä¸ªå¤§æ± å­ä½¿ç”¨ |
| **å¿«ç…§åŠŸèƒ½** | å¯ä»¥åˆ›å»ºç¬é—´å¿«ç…§ï¼Œç”¨äºå¤‡ä»½æˆ–å›æ»š |
| **çµæ´»åˆ†åŒº** | ä¸éœ€è¦é¢„å…ˆç²¾ç¡®è§„åˆ’åˆ†åŒºå¤§å° |
| **åŠ¨æ€åˆ†é…** | ä» VG ä¸­æŒ‰éœ€åˆ†é…ç©ºé—´ç»™ LV |

## 5.2 ç¼ºç‚¹

| ç¼ºç‚¹ | è¯´æ˜ |
|------|------|
| **æ€§èƒ½è½»å¾®æŸè€—** | å¢åŠ ä¸€å±‚æŠ½è±¡ï¼Œæ€§èƒ½ç•¥æœ‰ä¸‹é™ï¼ˆé€šå¸¸å¯å¿½ç•¥ï¼‰ |
| **å¤æ‚åº¦å¢åŠ ** | å¤šä¸€å±‚ç®¡ç†ç»“æ„ï¼Œå‡ºé—®é¢˜æ’æŸ¥éš¾åº¦å¢åŠ  |
| **æ¢å¤å¤æ‚** | ç³»ç»Ÿå´©æºƒæ—¶ï¼ŒLVM æ¢å¤æ¯”ä¼ ç»Ÿåˆ†åŒºå¤æ‚ |
| **å¼•å¯¼é™åˆ¶** | BIOS ç³»ç»Ÿä¸‹ï¼Œ/boot åˆ†åŒºé€šå¸¸ä¸èƒ½åœ¨ LVM ä¸Š |

# 6. åˆ›å»ºæ–°çš„é€»è¾‘å·

ä¹‹å‰çš„æµç¨‹æ˜¯æ‰©å®¹ç°æœ‰ LVï¼Œå¦‚æœä½ æƒ³**åˆ›å»ºå…¨æ–°çš„ LV**ï¼ˆæ¯”å¦‚ `/home`ã€`/data`ï¼‰ï¼š

## 6.1 æµç¨‹æ€»è§ˆ

`ä» VG åˆ†é…ç©ºé—´ â†’ åˆ›å»º LV â†’ æ ¼å¼åŒ– â†’ æŒ‚è½½ â†’ è®¾ç½®è‡ªåŠ¨æŒ‚è½½`

## 6.2 å…·ä½“æ­¥éª¤



### æ­¥éª¤ 1ï¼šåˆ›å»ºæ–° LV

ä» `ubuntu-vg` ä¸­åˆ†é… 50G ç»™æ–° LVï¼š

```bash
# æ–¹æ³• 1ï¼šæŒ‡å®šå¤§å°
sudo lvcreate -L 50G -n data-lv ubuntu-vg

# æ–¹æ³• 2ï¼šä½¿ç”¨å‰©ä½™æ‰€æœ‰ç©ºé—´
sudo lvcreate -l 100%FREE -n data-lv ubuntu-vg
```

å‚æ•°è¯´æ˜ï¼š
- `-L 50G`ï¼šæŒ‡å®šå¤§å°ä¸º 50G
- `-n data-lv`ï¼šæŒ‡å®š LV åå­—
- `-l 100%FREE`ï¼šä½¿ç”¨ VG ä¸­æ‰€æœ‰å‰©ä½™ç©ºé—´

### æ­¥éª¤ 2ï¼šéªŒè¯ LV åˆ›å»ºæˆåŠŸ

```bash
sudo lvs
```

è¾“å‡ºç¤ºä¾‹ï¼š

```bash
  LV         VG         Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
  ubuntu-lv  ubuntu-vg  -wi-ao----  398.00g
  data-lv    ubuntu-vg  -wi-a-----   50.00g
```

### æ­¥éª¤ 3ï¼šæ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿ

```bash
# ext4ï¼ˆæ¨èï¼‰
sudo mkfs.ext4 /dev/ubuntu-vg/data-lv

# æˆ–è€… xfs
sudo mkfs.xfs /dev/ubuntu-vg/data-lv
```

### æ­¥éª¤ 4ï¼šåˆ›å»ºæŒ‚è½½ç‚¹å¹¶æŒ‚è½½

```bash
# åˆ›å»ºæŒ‚è½½ç‚¹ç›®å½•
sudo mkdir /data

# æŒ‚è½½
sudo mount /dev/ubuntu-vg/data-lv /data
```

### æ­¥éª¤ 5ï¼šè®¾ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½

è·å– UUIDï¼š

```bash
sudo blkid /dev/ubuntu-vg/data-lv
```

ç¼–è¾‘ `/etc/fstab`ï¼š

```bash
sudo nano /etc/fstab
```

æ·»åŠ ï¼š

```
UUID=ä½ çš„UUID /data ext4 defaults 0 2
```

### æ­¥éª¤ 6ï¼šéªŒè¯

```bash
df -h
```

# 7. LVM å¿«ç…§ï¼ˆSnapshotï¼‰

## 7.1 ä»€ä¹ˆæ˜¯å¿«ç…§ï¼Ÿ

å¿«ç…§æ˜¯æŸä¸ª LV åœ¨æŸä¸€æ—¶åˆ»çš„**åªè¯»å‰¯æœ¬**ï¼Œç”¨äºï¼š

- ç¬é—´å¤‡ä»½ï¼ˆæ— éœ€åœæœºï¼‰
- æµ‹è¯•å‰çš„çŠ¶æ€ä¿å­˜
- æ•°æ®å›æ»š

## 7.2 åˆ›å»ºå¿«ç…§

```bash
# åˆ›å»º ubuntu-lv çš„å¿«ç…§ï¼Œå‘½å ubuntu-lv-snapï¼Œå¤§å° 10G
sudo lvcreate -L 10G -s -n ubuntu-lv-snap /dev/ubuntu-vg/ubuntu-lv
```

å‚æ•°è¯´æ˜ï¼š
- `-L 10G`ï¼šå¿«ç…§å¤§å°ï¼ˆå–å†³äºæ•°æ®å˜åŒ–é‡ï¼‰
- `-s`ï¼šè¡¨ç¤ºåˆ›å»ºå¿«ç…§
- `-n ubuntu-lv-snap`ï¼šå¿«ç…§åç§°

## 7.3 æŸ¥çœ‹å¿«ç…§

```bash
sudo lvs
```

å¿«ç…§ä¼šæ˜¾ç¤º `[ubuntu-lv]` è¡¨ç¤ºå®ƒæ˜¯å“ªä¸ª LV çš„å¿«ç…§ã€‚

## 7.4 æŒ‚è½½å¿«ç…§æŸ¥çœ‹å†…å®¹

```bash
sudo mkdir /mnt/snapshot
sudo mount /dev/ubuntu-vg/ubuntu-lv-snap /mnt/snapshot
ls /mnt/snapshot
```

## 7.5 åˆ é™¤å¿«ç…§

```bash
sudo lvremove /dev/ubuntu-vg/ubuntu-lv-snap
```

## 7.6 ä»å¿«ç…§æ¢å¤ï¼ˆè°¨æ…ï¼ï¼‰

```bash
# 1. å¸è½½åŸ LV
sudo umount /

# 2. ä»å¿«ç…§åˆ›å»ºæ–° LV
sudo lvcreate -s -n ubuntu-lv-new /dev/ubuntu-vg/ubuntu-lv-snap

# 3. é‡å‘½åï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo lvrename /dev/ubuntu-vg/ubuntu-lv /dev/ubuntu-vg/ubuntu-lv-old
sudo lvrename /dev/ubuntu-vg/ubuntu-lv-new /dev/ubuntu-vg/ubuntu-lv

# 4. æŒ‚è½½
sudo mount /dev/ubuntu-vg/ubuntu-lv /
```

# 8. ç¼©å° LVï¼ˆå±é™©æ“ä½œï¼‰

âš ï¸ **é‡è¦é™åˆ¶**ï¼š

- **xfs æ–‡ä»¶ç³»ç»Ÿä¸èƒ½ç¼©å°ï¼**åªèƒ½æ‰©å®¹
- ext4 å¯ä»¥ç¼©å°ï¼Œä½†å¿…é¡»å…ˆç¼©å°æ–‡ä»¶ç³»ç»Ÿï¼Œå†ç¼©å° LV

## 8.1 ç¼©å° ext4 LV çš„æ­¥éª¤

```bash
# 1. å¸è½½ LV
sudo umount /data

# 2. æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿï¼ˆå¿…é¡»ï¼‰
sudo e2fsck -f /dev/ubuntu-vg/data-lv

# 3. å…ˆç¼©å°æ–‡ä»¶ç³»ç»Ÿåˆ° 30G
sudo resize2fs /dev/ubuntu-vg/data-lv 30G

# 4. å†ç¼©å° LV åˆ° 30G
sudo lvreduce -L 30G /dev/ubuntu-vg/data-lv

# 5. é‡æ–°æŒ‚è½½
sudo mount /dev/ubuntu-vg/data-lv /data
```

# 9. åˆ é™¤ LVM ç»„ä»¶

åˆ é™¤é¡ºåºä¸åˆ›å»ºé¡ºåº**ç›¸å**ï¼š

`LV â†’ VG â†’ PV`

## 9.1 åˆ é™¤ LV

```bash
# å…ˆå¸è½½
sudo umount /data

# åˆ é™¤ LV
sudo lvremove /dev/ubuntu-vg/data-lv
```

## 9.2 ä» VG ä¸­ç§»é™¤ PV

```bash
# å¦‚æœ PV ä¸­è¿˜æœ‰æ•°æ®åœ¨ç”¨ï¼Œéœ€è¦å…ˆè¿ç§»æ•°æ®
sudo pvmove /dev/sdb1

# ä» VG ä¸­ç§»é™¤ PV
sudo vgreduce ubuntu-vg /dev/sdb1
```

## 9.3 åˆ é™¤ PV

```bash
sudo pvremove /dev/sdb1
```

# 10. å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

## 10.1 æŸ¥çœ‹å‘½ä»¤

| å‘½ä»¤ | ä½œç”¨ |
|------|------|
| `pvs` / `pvdisplay` | æŸ¥çœ‹æ‰€æœ‰ç‰©ç†å· |
| `vgs` / `vgdisplay` | æŸ¥çœ‹æ‰€æœ‰å·ç»„ |
| `lvs` / `lvdisplay` | æŸ¥çœ‹æ‰€æœ‰é€»è¾‘å· |
| `lsblk` | æŸ¥çœ‹æ•´ä½“ç£ç›˜ç»“æ„ |

## 10.2 ç®¡ç†å‘½ä»¤

| å‘½ä»¤ | ä½œç”¨ |
|------|------|
| `pvcreate /dev/sdb1` | åˆ›å»ºç‰©ç†å· |
| `vgcreate myvg /dev/sdb1` | åˆ›å»ºå·ç»„ |
| `vgextend myvg /dev/sdb2` | æ‰©å±•å·ç»„ï¼ˆæ·»åŠ  PVï¼‰|
| `lvcreate -L 50G -n mylv myvg` | åˆ›å»ºé€»è¾‘å· |
| `lvextend -L +100G /dev/myvg/mylv` | æ‰©å±•é€»è¾‘å· |
| `lvreduce -L 50G /dev/myvg/mylv` | ç¼©å°é€»è¾‘å· |
| `lvremove /dev/myvg/mylv` | åˆ é™¤é€»è¾‘å· |

## 10.3 æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤

| å‘½ä»¤ | ä½œç”¨ |
|------|------|
| `resize2fs /dev/vg/lv` | æ‰©å±•/ç¼©å° ext4 æ–‡ä»¶ç³»ç»Ÿ |
| `xfs_growfs /` | æ‰©å±• xfs æ–‡ä»¶ç³»ç»Ÿï¼ˆåªèƒ½æ‰©ï¼‰ |
| `mkfs.ext4 /dev/vg/lv` | æ ¼å¼åŒ–ä¸º ext4 |
| `mkfs.xfs /dev/vg/lv` | æ ¼å¼åŒ–ä¸º xfs |

# 11. ä¸ä¼ ç»Ÿåˆ†åŒºçš„å¯¹æ¯”

| å¯¹æ¯”é¡¹ | ä¼ ç»Ÿåˆ†åŒº | LVM |
|--------|----------|-----|
| **æ‰©å®¹** | éœ€è¦åœæœºï¼Œæ“ä½œå¤æ‚ | åœ¨çº¿æ“ä½œï¼Œç®€å• |
| **å¤§å°è°ƒæ•´** | å—åˆ†åŒºè¡¨é™åˆ¶ï¼Œéš¾ä»¥è°ƒæ•´ | çµæ´»è°ƒæ•´ |
| **å¤šç£ç›˜ä½¿ç”¨** | éœ€è¦æŒ‚è½½åˆ°ä¸åŒç›®å½• | å¯åˆå¹¶æˆä¸€ä¸ª VG |
| **å¿«ç…§** | ä¸æ”¯æŒ | æ”¯æŒ |
| **æ€§èƒ½** | æ— æŸè€— | è½»å¾®æŸè€— |
| **å¤æ‚åº¦** | ç®€å• | è¾ƒå¤æ‚ |
| **é€‚ç”¨åœºæ™¯** | ç®€å•æ¡Œé¢/åµŒå…¥å¼ | æœåŠ¡å™¨/éœ€è¦çµæ´»ç®¡ç†çš„ç³»ç»Ÿ |

# 12. LVM é™åˆ¶ä¸æ³¨æ„äº‹é¡¹

## 12.1 å¼•å¯¼åˆ†åŒºä¸èƒ½åœ¨ LVM ä¸Š

- **BIOS ç³»ç»Ÿ**ï¼š/boot åˆ†åŒºå¿…é¡»åœ¨ä¼ ç»Ÿåˆ†åŒºä¸Š
- **UEFI ç³»ç»Ÿ**ï¼šEFI System Partition (ESP) å¿…é¡»æ˜¯ FAT32 åˆ†åŒº

## 12.2 æ–‡ä»¶ç³»ç»Ÿé™åˆ¶

| æ–‡ä»¶ç³»ç»Ÿ | æ˜¯å¦æ”¯æŒç¼©å®¹ | æ˜¯å¦æ”¯æŒæ‰©å®¹ |
|----------|--------------|--------------|
| ext4 | âœ… | âœ… |
| xfs | âŒ | âœ… |
| btrfs | âœ… | âœ… |
| fat32 | âŒ | âŒ |
| ntfs | âš ï¸ (éœ€å·¥å…·) | âš ï¸ (éœ€å·¥å…·) |

## 12.3 å»ºè®®

1. **æ ¹åˆ†åŒºå»ºè®®ä½¿ç”¨ LVM**ï¼ˆæ–¹ä¾¿æ‰©å®¹ï¼‰
2. **/boot åˆ†åŒºä¸è¦ç”¨ LVM**ï¼ˆå…¼å®¹æ€§é—®é¢˜ï¼‰
3. **å¤§å®¹é‡æ•°æ®åˆ†åŒºå»ºè®®ç”¨ LVM**ï¼ˆçµæ´»ç®¡ç†ï¼‰
4. **å®šæœŸå¤‡ä»½ LVM å…ƒæ•°æ®**ï¼š

```bash
# å¤‡ä»½ VG å…ƒæ•°æ®
sudo vgcfgbackup -f /backup/vg-backup.conf ubuntu-vg
```
